{"version":3,"file":"main.js","sources":["node_modules/toad.jsx/lib/jsx-runtime.js","node_modules/toad.js/lib/src/Signal.js","node_modules/toad.js/lib/src/model/Model.js","node_modules/toad.js/lib/src/model/GenericModel.js","node_modules/toad.js/lib/src/model/BooleanModel.js","node_modules/toad.js/lib/src/model/NumberModel.js","node_modules/toad.js/lib/src/model/TextModel.js","node_modules/toad.js/lib/src/model/HtmlModel.js","node_modules/toad.js/lib/src/model/Action.js","node_modules/toad.js/lib/src/controller/Controller.js","node_modules/toad.js/lib/src/util/dom.js","node_modules/toad.js/lib/src/controller/Template.js","node_modules/toad.js/lib/src/controller/globalController.js","node_modules/toad.js/lib/src/util/animation.js","node_modules/toad.js/lib/src/view/View.js","node_modules/toad.js/lib/src/view/ModelView.js","node_modules/toad.js/lib/src/view/ActionView.js","node_modules/toad.js/lib/src/view/Button.js","node_modules/toad.js/lib/src/view/Checkbox.js","node_modules/toad.js/lib/src/view/Slider.js","node_modules/toad.js/lib/src/view/Text.js","node_modules/toad.js/lib/src/view/textAreaStyle.js","node_modules/toad.js/lib/src/view/TextTool.js","node_modules/toad.js/lib/src/view/TextArea.js","node_modules/toad.js/lib/src/view/GenericTool.js","node_modules/toad.js/lib/src/view/ToolButton.js","node_modules/toad.js/lib/src/view/SlotView.js","node_modules/toad.js/lib/src/view/ToadIf.js","node_modules/toad.js/lib/src/menu/menuStyle.js","node_modules/toad.js/lib/src/menu/MenuState.js","node_modules/toad.js/lib/src/menu/MenuHelper.js","node_modules/toad.js/lib/src/menu/PopupMenu.js","node_modules/toad.js/lib/src/menu/MenuButton.js","node_modules/toad.js/lib/src/menu/MenuNode.js","node_modules/toad.js/lib/src/menu/Menu.js","node_modules/toad.js/lib/src/menu/MenuSpacer.js","node_modules/toad.js/lib/src/util/scrollIntoView.js","node_modules/toad.js/lib/src/table/TableEditMode.js","node_modules/toad.js/lib/src/table/TableEventType.js","node_modules/toad.js/lib/src/table/TableModel.js","node_modules/toad.js/lib/src/table/TablePos.js","node_modules/toad.js/lib/src/table/SelectionModel.js","node_modules/toad.js/lib/src/table/TypedTableModel.js","node_modules/toad.js/lib/src/table/TableAdapter.js","node_modules/toad.js/lib/src/table/private/tableStyle.js","node_modules/toad.js/lib/src/table/private/InputOverlay.js","node_modules/toad.js/lib/src/table/private/RemoveRowAnimation.js","node_modules/toad.js/lib/src/table/TableView.js","node_modules/toad.js/lib/src/table/private/InsertRowAnimation.js","node_modules/toad.js/lib/src/table/TableEvent.js","node_modules/toad.js/lib/src/table/ArrayTableModel.js","node_modules/toad.js/lib/src/table/TableTool.js","node_modules/toad.js/lib/src/table/TypedTableAdapter.js","node_modules/toad.js/lib/src/table/TreeModel.js","node_modules/toad.js/lib/src/table/TreeAdapter.js","node_modules/toad.js/lib/src/table/TreeNodeModel.js","node_modules/toad.js/lib/src/table/ArrayModel.js","node_modules/toad.js/lib/src/table/ArrayAdapter.js","node_modules/toad.js/lib/src/menu/MenuEntry.js","node_modules/toad.js/lib/src/index.js","main.ts"],"sourcesContent":["export class Reference {\n    constructor(object, attribute) {\n        this.object = object;\n        this.attribute = attribute.toString();\n    }\n    get() {\n        return this.object[this.attribute];\n    }\n    set(value) {\n        Object.defineProperty(this.object, this.attribute, { value: value });\n    }\n    toString() {\n        return `${this.object[this.attribute]}`;\n    }\n    fromString(value) {\n        const type = typeof this.object[this.attribute];\n        let outValue;\n        switch (type) {\n            case \"string\":\n                outValue = value;\n                break;\n            case \"number\":\n                outValue = Number.parseFloat(value);\n                break;\n            default:\n                throw Error(`Reference.fromString() isn't yet supported for type ${type}`);\n        }\n        Object.defineProperty(this.object, this.attribute, { value: outValue });\n    }\n}\nexport function ref(object, attribute) {\n    return new Reference(object, attribute);\n}\nexport function refs(object, ...attributes) {\n    return attributes.map(a => new Reference(object, a));\n}\nexport class Fragment extends Array {\n    constructor(props) {\n        super(...props?.children);\n        for (let i = 0; i < this.length; ++i) {\n            const e = this[i];\n            if (typeof e === \"string\") {\n                this[i] = document.createTextNode(e);\n            }\n        }\n    }\n    replaceIn(element) {\n        while (element.childNodes.length > 0) {\n            element.removeChild(element.childNodes[element.childNodes.length - 1]);\n        }\n        this.appendTo(element);\n    }\n    appendTo(element) {\n        for (let child of this) {\n            element.appendChild(child);\n        }\n    }\n}\nexport function jsx(nameOrConstructor, props, key) {\n    if (props !== undefined && props.children !== undefined) {\n        props.children = [props.children];\n    }\n    return jsxs(nameOrConstructor, props);\n}\nexport function jsxs(nameOrConstructor, props, key) {\n    let namespace;\n    if (typeof nameOrConstructor !== 'string') {\n        return new nameOrConstructor(props);\n    }\n    const name = nameOrConstructor;\n    switch (name) {\n        case \"svg\":\n        case \"line\":\n        case \"rect\":\n        case \"circle\":\n        case \"path\":\n        case \"text\":\n            namespace = \"http://www.w3.org/2000/svg\";\n            break;\n        default:\n            namespace = \"http://www.w3.org/1999/xhtml\";\n    }\n    const tag = document.createElementNS(namespace, name);\n    setInitialProperties(tag, props, namespace);\n    return tag;\n}\nexport function setInitialProperties(element, props, namespace) {\n    if (props === null || props === undefined)\n        return;\n    for (let [key, value] of Object.entries(props)) {\n        switch (key) {\n            case 'children':\n                break;\n            case 'action':\n                element.setAction(value);\n                break;\n            case 'model':\n                element.setModel(value);\n                break;\n            case 'class':\n                element.classList.add(value);\n                break;\n            case 'style':\n                for (let [skey, svalue] of Object.entries(value)) {\n                    const regex = /[A-Z]/g;\n                    skey = skey.replace(regex, (upperCase) => \"-\" + upperCase.toLowerCase());\n                    element.style.setProperty(skey, svalue);\n                }\n                break;\n            case 'set':\n                Object.defineProperty(props.set.object, props.set.attribute, { value: element });\n                break;\n            default:\n                if (key.substring(0, 2) === \"on\") {\n                    element.addEventListener(key.substr(2), value);\n                }\n                else {\n                    if (typeof value !== \"object\") {\n                        if (namespace === \"http://www.w3.org/2000/svg\") {\n                            const regex = /[A-Z]/g;\n                            key = key.replace(regex, (upperCase) => \"-\" + upperCase.toLowerCase());\n                        }\n                        element.setAttributeNS(null, key, `${value}`);\n                    }\n                }\n        }\n    }\n    if (props.children !== undefined) {\n        for (let child of props.children) {\n            if (typeof child === \"string\") {\n                element.appendChild(document.createTextNode(child));\n            }\n            else {\n                element.appendChild(child);\n            }\n        }\n    }\n}\nexport function createElement(nameOrConstructor, props, ...children) {\n    let key;\n    if (props !== null) {\n        if ('key' in props) {\n            key = props.key;\n            delete props.key;\n        }\n        if (children !== undefined) {\n            props.children = children;\n        }\n    }\n    else {\n        if (children !== undefined)\n            props = { children };\n    }\n    return jsxs(nameOrConstructor, props, key);\n}\n//# sourceMappingURL=jsx-runtime.js.map","export class SignalLink {\n    constructor(callback, id) {\n        this.callback = callback;\n        this.id = id;\n    }\n}\nexport class Signal {\n    add(callback, id) {\n        if (!this.callbacks)\n            this.callbacks = new Array();\n        this.callbacks.push(new SignalLink(callback, id));\n    }\n    remove(id) {\n        if (!this.callbacks)\n            return;\n        for (let i = this.callbacks.length - 1; i >= 0; --i) {\n            if (this.callbacks[i].id === id)\n                this.callbacks.splice(i, 1);\n        }\n    }\n    count() {\n        if (!this.callbacks)\n            return 0;\n        return this.callbacks.length;\n    }\n    lock() {\n        this.locked = true;\n    }\n    unlock() {\n        this.locked = undefined;\n        if (this.triggered) {\n            let data = this.triggered.data;\n            this.triggered = undefined;\n            this.trigger(data);\n        }\n    }\n    trigger(data) {\n        if (this.locked) {\n            this.triggered = { data: data };\n            return;\n        }\n        if (!this.callbacks)\n            return;\n        for (let i = 0; i < this.callbacks.length; ++i)\n            this.callbacks[i].callback(data);\n    }\n}\n//# sourceMappingURL=Signal.js.map","import { Signal } from \"../Signal.js\";\nexport class Model {\n    constructor() {\n        this.modified = new Signal();\n    }\n}\n//# sourceMappingURL=Model.js.map","import { Model } from \"./Model.js\";\nexport class GenericModel extends Model {\n    constructor(value) {\n        super();\n        this._value = value;\n    }\n    set value(value) {\n        if (this._value == value)\n            return;\n        this._value = value;\n        this.modified.trigger();\n    }\n    get value() {\n        return this._value;\n    }\n}\n//# sourceMappingURL=GenericModel.js.map","import { GenericModel } from \"./GenericModel.js\";\nexport class BooleanModel extends GenericModel {\n    constructor(value) {\n        super(value);\n    }\n}\n//# sourceMappingURL=BooleanModel.js.map","import { GenericModel } from \"./GenericModel.js\";\nexport class NumberModel extends GenericModel {\n    constructor(value, options) {\n        super(value);\n        if (options) {\n            this.min = options.min;\n            this.max = options.max;\n            this.step = options.step;\n        }\n    }\n}\n//# sourceMappingURL=NumberModel.js.map","import { Model } from \"./Model.js\";\nexport class TextModel extends Model {\n    constructor(value) {\n        super();\n        this._value = value;\n    }\n    set promise(promise) {\n        this._value = promise;\n        this.modified.trigger();\n    }\n    get promise() {\n        if (typeof this._value === \"string\") {\n            return () => {\n                return this._value;\n            };\n        }\n        return this._value;\n    }\n    set value(value) {\n        if (this._value === value)\n            return;\n        if (typeof value !== \"string\") {\n            console.trace(`TextModel.set value(value: string): ${typeof value} is not type string`);\n            return;\n        }\n        this._value = value;\n        this.modified.trigger();\n    }\n    get value() {\n        switch (typeof this._value) {\n            case \"number\":\n            case \"string\":\n                this._value = `${this._value}`;\n                break;\n            case \"function\":\n                this._value = this._value();\n                break;\n        }\n        return this._value;\n    }\n}\n//# sourceMappingURL=TextModel.js.map","import { TextModel } from \"./TextModel.js\";\nexport class HtmlModel extends TextModel {\n    constructor(value) {\n        super(value);\n    }\n}\n//# sourceMappingURL=HtmlModel.js.map","import { Model } from \"./Model.js\";\nimport { Signal } from \"../Signal.js\";\nexport class Action extends Model {\n    constructor(parent, title) {\n        super();\n        this.signal = new Signal();\n        this.title = title;\n        this._enabled = true;\n    }\n    set value(placeHolder) {\n        throw Error(\"Action.value can not be assigned a value\");\n    }\n    get value() {\n        throw Error(\"Action.value can not return a value\");\n    }\n    set enabled(enabled) {\n        if (this._enabled == enabled)\n            return;\n        this._enabled = enabled;\n        this.modified.trigger();\n    }\n    get enabled() {\n        return this._enabled;\n    }\n    trigger(data) {\n        if (!this._enabled)\n            return;\n        this.signal.trigger(data);\n    }\n}\n//# sourceMappingURL=Action.js.map","import { BooleanModel } from \"../model/BooleanModel.js\";\nimport { NumberModel } from \"../model/NumberModel.js\";\nimport { HtmlModel } from \"../model/HtmlModel.js\";\nimport { TextModel } from \"../model/TextModel.js\";\nimport { Action } from \"../model/Action.js\";\nimport { Signal } from \"../Signal.js\";\nexport class Controller {\n    constructor() {\n        this.modelId2Models = new Map();\n        this.modelId2Views = new Map();\n        this.view2ModelIds = new Map();\n        this.sigChanged = new Signal();\n    }\n    registerAction(actionId, callback) {\n        let action = new Action(undefined, actionId);\n        action.signal.add(callback);\n        this._registerModel(\"A:\" + actionId, action);\n        return action;\n    }\n    registerModel(modelId, model) {\n        this._registerModel(\"M:\" + modelId, model);\n    }\n    _registerModel(modelId, model) {\n        let modelsForModelId = this.modelId2Models.get(modelId);\n        if (!modelsForModelId) {\n            modelsForModelId = new Set();\n            this.modelId2Models.set(modelId, modelsForModelId);\n        }\n        modelsForModelId.add(model);\n        let viewsForModelId = this.modelId2Views.get(modelId);\n        if (!viewsForModelId)\n            return;\n        for (let view of viewsForModelId) {\n            view.setModel(model);\n        }\n    }\n    registerView(modelId, view) {\n        if (view.controller && view.controller !== this) {\n            console.log(\"error: attempt to register view more than once at different controllers\");\n            return;\n        }\n        view.controller = this;\n        let modelIdsForView = this.view2ModelIds.get(view);\n        if (!modelIdsForView) {\n            modelIdsForView = new Set();\n            this.view2ModelIds.set(view, modelIdsForView);\n        }\n        modelIdsForView.add(modelId);\n        let viewsForModelId = this.modelId2Views.get(modelId);\n        if (!viewsForModelId) {\n            viewsForModelId = new Set();\n            this.modelId2Views.set(modelId, viewsForModelId);\n        }\n        viewsForModelId.add(view);\n        let modelsForView = this.modelId2Models.get(modelId);\n        if (!modelsForView)\n            return;\n        for (let model of modelsForView) {\n            view.setModel(model);\n        }\n    }\n    unregisterView(view) {\n        if (!view.controller)\n            return;\n        if (view.controller !== this)\n            throw Error(\"attempt to unregister view from wrong controller\");\n        let modelIds = this.view2ModelIds.get(view);\n        if (!modelIds)\n            return;\n        for (let modelId of modelIds) {\n            let views = this.modelId2Views.get(modelId);\n            if (!views)\n                continue;\n            views.delete(view);\n            if (views.size === 0) {\n                this.modelId2Views.delete(modelId);\n            }\n            view.setModel(undefined);\n        }\n    }\n    clear() {\n        for (let entry of this.view2ModelIds) {\n            entry[0].setModel(undefined);\n        }\n        this.modelId2Models.clear();\n        this.modelId2Views.clear();\n        this.view2ModelIds.clear();\n    }\n    bind(modelId, model) {\n        this.registerModel(modelId, model);\n    }\n    action(actionId, callback) {\n        return this.registerAction(actionId, callback);\n    }\n    text(modelId, value) {\n        let model = new TextModel(value);\n        this.bind(modelId, model);\n        return model;\n    }\n    html(modelId, value) {\n        let model = new HtmlModel(value);\n        this.bind(modelId, model);\n        return model;\n    }\n    boolean(modelId, value) {\n        let model = new BooleanModel(value);\n        this.bind(modelId, model);\n        return model;\n    }\n    number(modelId, value, options) {\n        let model = new NumberModel(value, options);\n        this.bind(modelId, model);\n        return model;\n    }\n}\n//# sourceMappingURL=Controller.js.map","export function instantiateTemplate(name) {\n    return tmpl(name);\n}\nexport function tmpl(name) {\n    let t = document.querySelector('template[id=\"' + name + '\"]');\n    if (!t) {\n        throw new Error(\"failed to find template '\" + name + \"'\");\n    }\n    let x = t;\n    let z = x.content;\n    let y = document.importNode(z, true);\n    return y;\n}\nexport function find(node, selector) {\n    return node.querySelector(selector);\n}\nexport function tag(name) { return document.createElement(name); }\nexport function txt(txt) { return document.createTextNode(txt); }\nexport function img(src) {\n    let img = document.createElement(\"img\");\n    img.src = src;\n    return img;\n}\nexport function add(n0, n1) { n0.appendChild(n1); }\nexport function remove(n) {\n    if (!n.parentNode)\n        throw Error(\"element has no parent\");\n    n.parentNode.removeChild(n);\n}\nexport function erase(n) {\n    while (n.firstChild)\n        n.removeChild(n.firstChild);\n}\nexport function hasFocus(element) {\n    if (!document.hasFocus())\n        return false;\n    let active = document.activeElement;\n    while (active !== null) {\n        if (active === element) {\n            return true;\n        }\n        if (active.shadowRoot === null)\n            break;\n        active = active.shadowRoot.activeElement;\n    }\n    return false;\n}\nexport function grabMouse(event) {\n    let target = event.target;\n    let documentMouseMove = (event) => {\n        target.dispatchEvent(new MouseEvent(\"mousemove\", event));\n        event.stopPropagation();\n    };\n    let documentMouseUp = (event) => {\n        target.dispatchEvent(new MouseEvent(\"mouseup\", event));\n        document.removeEventListener(\"mousemove\", documentMouseMove, { capture: true });\n        document.removeEventListener(\"mouseup\", documentMouseUp, { capture: true });\n        document.body.style.pointerEvents = \"auto\";\n        event.stopPropagation();\n    };\n    document.addEventListener(\"mousemove\", documentMouseMove, { capture: true });\n    document.addEventListener(\"mouseup\", documentMouseUp, { capture: true });\n    document.body.style.pointerEvents = \"none\";\n    event.preventDefault();\n    event.stopPropagation();\n}\nexport function attribute(element, name) {\n    let attribute = element.getAttribute(name);\n    if (attribute === null) {\n        console.log(\"missing attribute '\" + name + \"' in \", element);\n        throw Error(\"missing attribute '\" + name + \"' in \" + element.nodeName);\n    }\n    return attribute;\n}\nexport function attributeOrUndefined(element, name) {\n    let attribute = element.getAttribute(name);\n    return attribute === null ? undefined : attribute;\n}\nexport function isNodeBeforeNode(first, second) {\n    let node;\n    let firstPrevious = first;\n    node = first;\n    let parentsOfFirstNode = new Map();\n    while (true) {\n        firstPrevious = node;\n        node = node.parentNode;\n        if (!node)\n            break;\n        parentsOfFirstNode.set(node, firstPrevious);\n    }\n    let secondPrevious = second;\n    node = second;\n    while (node) {\n        secondPrevious = node;\n        node = node.parentNode;\n        if (!node) {\n            throw Error(`isNodeBeforeNode(first, second): nodes have no common parent`);\n        }\n        let lookup = parentsOfFirstNode.get(node);\n        if (lookup) {\n            firstPrevious = lookup;\n            break;\n        }\n    }\n    for (let child of node.childNodes) {\n        if (child === firstPrevious)\n            return true;\n        if (child === secondPrevious)\n            return false;\n    }\n    throw Error(\"isNodeBeforeNode(first, second): couldn't determine order of nodes\");\n}\nexport function pixelToNumber(pixel) {\n    if (pixel === \"\")\n        return 0;\n    if (pixel.substr(pixel.length - 2) !== \"px\")\n        throw Error(`TableView.pixelToNumber('${pixel}') expected 'px' suffix`);\n    return Number.parseFloat(pixel.substr(0, pixel.length - 2));\n}\nexport function getPropertyValue(element, propertyName) {\n    let elementStyle = window.getComputedStyle(element, undefined);\n    let property = elementStyle.getPropertyValue(propertyName);\n    return pixelToNumber(property);\n}\nexport function horizontalPadding(element) {\n    return getPropertyValue(element, \"padding-left\") + getPropertyValue(element, \"padding-right\");\n}\nexport function verticalPadding(element) {\n    return getPropertyValue(element, \"padding-top\") + getPropertyValue(element, \"padding-bottom\");\n}\n//# sourceMappingURL=dom.js.map","import * as dom from \"../util/dom.js\";\nimport { Controller } from \"./Controller.js\";\nexport class Template extends Controller {\n    constructor(template) {\n        super();\n        this.root = dom.instantiateTemplate(template);\n        this.registerViews();\n    }\n    registerViews() {\n        let views = this.root.querySelectorAll(\"[model]\");\n        for (let element of views) {\n            let view = element;\n            if (!view)\n                continue;\n            try {\n                this.registerView(view.getModelId(), view);\n            }\n            catch (e) {\n            }\n        }\n        views = this.root.querySelectorAll(\"[action]\");\n        for (let element of views) {\n            let view = element;\n            if (!view)\n                continue;\n            try {\n                this.registerView(view.getActionId(), view);\n            }\n            catch (e) {\n            }\n        }\n    }\n    openHref(href) {\n    }\n}\n//# sourceMappingURL=Template.js.map","import { Controller } from \"./Controller.js\";\nexport let globalController = new Controller();\nexport function bindModel(modelId, model) {\n    globalController.bind(modelId, model);\n}\nexport function action(actionId, action) {\n    return globalController.registerAction(actionId, action);\n}\nexport function unbind() {\n    globalController.clear();\n}\nexport function text(modelId, value) {\n    return globalController.text(modelId, value);\n}\nexport function boolean(modelId, value) {\n    return globalController.boolean(modelId, value);\n}\n//# sourceMappingURL=globalController.js.map","export class AnimationBase {\n    constructor() {\n        this._stop = false;\n        this._firstFrame = this._firstFrame.bind(this);\n        this._animationFrame = this._animationFrame.bind(this);\n    }\n    start() {\n        this.prepare();\n        if (this._stop === true)\n            return;\n        this.requestAnimationFrame(this._firstFrame);\n    }\n    stop() {\n        this._stop = true;\n        if (this.animator?.current === this)\n            this.animator.current = undefined;\n    }\n    replace(animation) {\n        this.next = animation;\n        this.animationFrame(1);\n        this.lastFrame();\n        animation.prepare();\n    }\n    prepare() { }\n    firstFrame() { }\n    animationFrame(value) { }\n    lastFrame() { }\n    requestAnimationFrame(callback) {\n        window.requestAnimationFrame(callback);\n    }\n    _firstFrame(time) {\n        this.startTime = time;\n        this.firstFrame();\n        if (this._stop)\n            return;\n        this.animationFrame(0);\n        this.requestAnimationFrame(this._animationFrame);\n    }\n    _animationFrame(time) {\n        if (this.next) {\n            this.next._firstFrame(time);\n            return;\n        }\n        let elapsed = AnimationBase.animationFrameCount > 0 ? (time - this.startTime) / AnimationBase.animationFrameCount : 1;\n        elapsed = elapsed > 1 ? 1 : elapsed;\n        const value = this.ease(elapsed);\n        this.animationFrame(value);\n        if (this._stop) {\n            return;\n        }\n        if (value < 1.0) {\n            this.requestAnimationFrame(this._animationFrame.bind(this));\n        }\n        else {\n            this.lastFrame();\n            if (this.animator?.current === this)\n                this.animator.current = undefined;\n        }\n    }\n    ease(k) {\n        return 0.5 * (1 - Math.cos(Math.PI * k));\n    }\n}\nAnimationBase.animationFrameCount = 468;\nexport class Animator {\n    run(animation) {\n        const current = this.current;\n        this.current = animation;\n        animation.animator = this;\n        if (current) {\n            current.animator = undefined;\n            current.replace(animation);\n        }\n        else {\n            animation.start();\n        }\n    }\n}\n//# sourceMappingURL=animation.js.map","import { globalController } from \"../controller/globalController.js\";\nimport { setInitialProperties } from \"toad.jsx\";\nexport class View extends HTMLElement {\n    constructor(props) {\n        super();\n        setInitialProperties(this, props);\n    }\n    static define(name, view, options) {\n        const element = window.customElements.get(name);\n        if (element === undefined) {\n            window.customElements.define(name, view, options);\n        }\n        else {\n            if (element !== view) {\n                console.trace(`View::define(${name}, ...): attempt to redefine view with different constructor`);\n            }\n        }\n    }\n    setModel(model) {\n        console.trace(`Please note that View.setModel(model) has no implementation.`);\n    }\n    getModelId() {\n        if (!this.hasAttribute(\"model\"))\n            throw Error(\"no 'model' attribute\");\n        let modelId = this.getAttribute(\"model\");\n        if (!modelId)\n            throw Error(\"no model id\");\n        return \"M:\" + modelId;\n    }\n    getActionId() {\n        if (!this.hasAttribute(\"action\"))\n            throw Error(\"no 'action' attribute\");\n        let actionId = this.getAttribute(\"action\");\n        if (!actionId)\n            throw Error(\"no action id\");\n        return \"A:\" + actionId;\n    }\n    connectedCallback() {\n        if (this.controller)\n            return;\n        let modelId = \"\";\n        try {\n            modelId = this.getModelId();\n        }\n        catch (error) {\n        }\n        if (modelId != \"\")\n            globalController.registerView(modelId, this);\n    }\n    disconnectedCallback() {\n        if (this.controller)\n            this.controller.unregisterView(this);\n    }\n}\n//# sourceMappingURL=View.js.map","import { View } from \"./View.js\";\nexport class ModelView extends View {\n    constructor(init) {\n        super(init);\n    }\n    updateModel() { }\n    updateView(data) { }\n    setModel(model) {\n        if (model === this.model)\n            return;\n        const view = this;\n        if (this.model)\n            this.model.modified.remove(view);\n        if (model)\n            model.modified.add((data) => view.updateView(data), view);\n        this.model = model;\n        if (this.isConnected)\n            this.updateView(undefined);\n    }\n    connectedCallback() {\n        super.connectedCallback();\n        if (this.model)\n            this.updateView(undefined);\n    }\n}\n//# sourceMappingURL=ModelView.js.map","import { TextModel } from \"../model/TextModel.js\";\nimport { globalController } from \"../controller/globalController.js\";\nimport { Action } from \"../model/Action.js\";\nimport { ModelView } from \"./ModelView.js\";\nexport class ActionView extends ModelView {\n    constructor(init) {\n        super(init);\n    }\n    connectedCallback() {\n        if (this.controller) {\n            this.updateView();\n            return;\n        }\n        try {\n            globalController.registerView(this.getActionId(), this);\n        }\n        catch (e) {\n        }\n        try {\n            globalController.registerView(this.getModelId(), this);\n        }\n        catch (e) {\n        }\n        this.updateView();\n    }\n    disconnectedCallback() {\n        super.disconnectedCallback();\n        if (this.controller)\n            this.controller.unregisterView(this);\n    }\n    setModel(model) {\n        if (!model) {\n            if (this.model)\n                this.model.modified.remove(this);\n            if (this.action)\n                this.action.modified.remove(this);\n            this.model = undefined;\n            this.action = undefined;\n            this.updateView();\n            return;\n        }\n        if (model instanceof Action) {\n            this.action = model;\n            this.action.modified.add(() => {\n                this.updateView();\n            }, this);\n        }\n        else if (model instanceof TextModel) {\n            this.model = model;\n            this.model.modified.add(() => {\n                this.updateView();\n            }, this);\n        }\n        else {\n            throw Error(\"unexpected model of type \" + model.constructor.name);\n        }\n        this.updateView();\n    }\n    setAction(value) {\n        if (value instanceof Function) {\n            const action = new Action(undefined, \"\");\n            action.signal.add(value);\n            this.setModel(action);\n        }\n        else {\n            this.setModel(value);\n        }\n    }\n    isEnabled() {\n        return this.action !== undefined && this.action.enabled;\n    }\n}\n//# sourceMappingURL=ActionView.js.map","import { HtmlModel } from \"../model/HtmlModel.js\";\nimport { ActionView } from \"./ActionView.js\";\nlet buttonStyle = document.createElement(\"style\");\nbuttonStyle.textContent = `\n  button {\n    border: none;\n    background-color: var(--toad-primary-color, #0052cc);\n    color: #ffffff;\n    border-radius: 3px;\n    font-size: 14px;\n    font-weight: bold;\n    height: 32px;\n    line-height: 32px;\n    min-width: 24px;\n    text-shadow: none;\n    padding: 0 10px;\n    margin-right: 4px;\n  }\n  \n  button:hover {\n    background-color: #0065ff;\n  }\n  \n  button:hover:active {\n    background-color: #0049b0;\n  }\n  \n  button:disabled, button:disabled:active {\n    background-color: #888;\n  }\n`;\nexport class Button extends ActionView {\n    constructor(init) {\n        super(init);\n        this.button = document.createElement(\"button\");\n        this.button.onclick = () => {\n            if (this.action)\n                this.action.trigger();\n        };\n        this.button.disabled = true;\n        this.attachShadow({ mode: 'open' });\n        this.shadowRoot.appendChild(document.importNode(buttonStyle, true));\n        this.shadowRoot.appendChild(this.button);\n    }\n    connectedCallback() {\n        super.connectedCallback();\n        if (this.children.length === 0) {\n            this._observer = new MutationObserver((record, observer) => {\n                if (this._timer !== undefined)\n                    clearTimeout(this._timer);\n                this._timer = window.setTimeout(() => {\n                    this._timer = undefined;\n                    this.updateView();\n                }, 100);\n            });\n            this._observer.observe(this, {\n                childList: true,\n                subtree: true,\n                characterData: true\n            });\n        }\n    }\n    updateView() {\n        if (!this.isConnected)\n            return;\n        if (this.model && this.model.value) {\n            if (this.model instanceof HtmlModel)\n                this.button.innerHTML = this.model.value;\n            else\n                this.button.innerText = this.model.value;\n        }\n        else {\n            this.button.innerHTML = this.innerHTML;\n        }\n        this.button.disabled = !this.isEnabled();\n    }\n}\n//# sourceMappingURL=Button.js.map","import { BooleanModel } from \"../model/BooleanModel.js\";\nimport { ModelView } from \"./ModelView.js\";\nlet checkboxStyle = document.createElement(\"style\");\ncheckboxStyle.textContent = `\nsvg {\n  width: 12px;\n  height: 12px;\n  vertical-align: middle;\n  margin: 3px;              /* space for the outline */\n  background: none;\n}\nsvg:focus {\n  outline-offset: -2px;     /* bring outline in touch with the svg */\n  background: #9eccfb;      /* the rectangle is rounded, fill the corners */\n  outline-color: 9eccfb;    /* outline shall be the same color used to fill the corners */\n}\n@media(pointer: coarse) { /* works on Chrome but iOS is never coarse :( */\n  svg {\n    width: 18px;\n    height: 18px;\n  }\n}\nsvg rect {\n  stroke: var(--border-color, var(--toad-neutral-color, #aaa));\n  fill: var(--background-color, #fff);\n  stroke-width: 1px;\n}\nsvg path {\n  stroke: var(--marker-color, none);\n  fill: none;\n  stroke-width: 2px;\n}\n:host([checked]) svg rect {\n  stroke: var(--checked-border-color, var(--toad-primary-color, #0052cc));\n  fill: var(--checked-background-color, var(--toad-primary-color, #0052cc));\n}\n:host([checked]) svg path {\n  stroke: var(--checked-marker-color, var(--toad-light-color, #fff));\n}\n:host([disabled]) svg rect {\n  stroke: var(--checked-border-color, var(--toad-primary-color, #bdbdbd));\n  fill: var(--checked-background-color, var(--toad-primary-color, #fff));\n}\n:host([disabled]) svg path {\n  stroke: var(--checked-marker-color, var(--toad-light-color, none));\n}\n:host([checked][disabled]) svg path {\n  stroke: var(--checked-marker-color, var(--toad-light-color, #bdbdbd));\n}`;\nexport class Checkbox extends ModelView {\n    constructor() {\n        super();\n        let svg = document.createElementNS(\"http://www.w3.org/2000/svg\", \"svg\");\n        svg.setAttributeNS(\"\", \"viewBox\", \"0 0 18 18\");\n        let rect = document.createElementNS(\"http://www.w3.org/2000/svg\", \"rect\");\n        rect.setAttributeNS(\"\", \"x\", \"1\");\n        rect.setAttributeNS(\"\", \"y\", \"1\");\n        rect.setAttributeNS(\"\", \"width\", \"16\");\n        rect.setAttributeNS(\"\", \"height\", \"16\");\n        rect.setAttributeNS(\"\", \"rx\", \"3\");\n        rect.setAttributeNS(\"\", \"ry\", \"3\");\n        let checkmark = document.createElementNS(\"http://www.w3.org/2000/svg\", \"path\");\n        checkmark.setAttributeNS(\"\", \"d\", \"M4 9.5 L 7.5 13 L 14.5 4\");\n        svg.onclick = () => {\n            this.toggle();\n        };\n        svg.setAttributeNS(\"\", \"tabindex\", \"0\");\n        svg.addEventListener(\"keydown\", (event) => {\n            if (event.key === \" \") {\n                this.toggle();\n            }\n        });\n        svg.onmousedown = (event) => {\n            svg.focus();\n            event.preventDefault();\n        };\n        svg.appendChild(rect);\n        svg.appendChild(checkmark);\n        this.attachShadow({ mode: 'open' });\n        this.shadowRoot.appendChild(document.importNode(checkboxStyle, true));\n        this.shadowRoot.appendChild(svg);\n    }\n    setModel(model) {\n        if (model !== undefined && !(model instanceof BooleanModel)) {\n            throw Error(`CheckBoxView.setModel(): model is not of type BooleanModel`);\n        }\n        super.setModel(model);\n    }\n    static get observedAttributes() { return ['checked']; }\n    attributeChangedCallback(name, oldValue, newValue) {\n        switch (name) {\n            case \"checked\":\n                this.updateModel();\n                break;\n        }\n    }\n    toggle() {\n        if (this.hasAttribute(\"disabled\"))\n            return;\n        if (this.hasAttribute(\"checked\"))\n            this.removeAttribute(\"checked\");\n        else\n            this.setAttribute(\"checked\", \"\");\n        this.updateModel();\n    }\n    updateModel() {\n        if (this.model) {\n            this.model.value = this.hasAttribute(\"checked\");\n        }\n    }\n    updateView() {\n        if (!this.model) {\n            this.setAttribute(\"disabled\", \"\");\n            this.removeAttribute(\"checked\");\n            return;\n        }\n        this.removeAttribute(\"disabled\");\n        if (this.model.value)\n            this.setAttribute(\"checked\", \"\");\n        else\n            this.removeAttribute(\"checked\");\n    }\n}\n//# sourceMappingURL=Checkbox.js.map","import { ModelView } from \"./ModelView.js\";\nexport class Slider extends ModelView {\n    constructor() {\n        super();\n        this.input = document.createElement(\"input\");\n        this.input.type = \"range\";\n        let view = this;\n        this.input.oninput = () => { view.updateModel(); };\n        this.attachShadow({ mode: 'open' })\n            .appendChild(this.input);\n    }\n    updateModel() {\n        if (this.model)\n            this.model.value = Number.parseFloat(this.input.value);\n    }\n    updateView() {\n        if (!this.model)\n            return;\n        if (this.model.step === undefined && this.model.min !== undefined && this.model.max !== undefined)\n            this.input.step = `${(this.model.max - this.model.min) / 100}`;\n        else\n            this.input.step = String(this.model.step);\n        this.input.min = String(this.model.min);\n        this.input.max = String(this.model.max);\n        this.input.value = String(this.model.value);\n    }\n}\n//# sourceMappingURL=Slider.js.map","import { ModelView } from \"./ModelView.js\";\nlet textStyle = document.createElement(\"style\");\ntextStyle.textContent = `\ninput {\n  font-family: var(--toad-font-family, sans-serif);\n  font-size: var(--toad-font-size, 12px);\n  border: 1px #ccc solid;\n  border-radius: 3px;\n  margin: 2px;\n  padding: 4px 5px;\n}\n\n:host(.embedded) input {\n  border: none 0;\n  border-radius: 0;\n  padding: 0;\n  margin: 2px;\n  width: 100%;\n  background: #fff;\n}\n`;\nexport class Text extends ModelView {\n    constructor(init) {\n        super(init);\n        this.input = document.createElement(\"input\");\n        this.input.oninput = () => { this.updateModel(); };\n        this.attachShadow({ mode: 'open' });\n        this.shadowRoot.appendChild(document.importNode(textStyle, true));\n        this.shadowRoot.appendChild(this.input);\n    }\n    focus() {\n        this.input.focus();\n    }\n    blur() {\n        this.input.blur();\n    }\n    static get observedAttributes() { return ['value']; }\n    attributeChangedCallback(name, oldValue, newValue) {\n        switch (name) {\n            case \"value\":\n                if (this.model && newValue !== undefined) {\n                    this.model.value = newValue;\n                }\n                break;\n        }\n    }\n    updateModel() {\n        if (this.model) {\n            this.model.value = this.input.value;\n        }\n        this.setAttribute(\"value\", this.input.value);\n    }\n    updateView() {\n        if (!this.model)\n            return;\n        const strValue = `${this.model.value}`;\n        if (this.input.value !== strValue) {\n            this.input.value = strValue;\n            this.setAttribute(\"value\", this.input.value);\n        }\n    }\n    get value() {\n        return this.input.value;\n    }\n    set value(value) {\n        this.input.value = value;\n        this.updateModel();\n    }\n}\n//# sourceMappingURL=Text.js.map","export let textAreaStyle = document.createElement(\"style\");\ntextAreaStyle.textContent = `\n\n/* try to follow material ui: when active render button labels in black, otherwise in gray */\nsvg .fill {\n  fill: #ccc;\n  stroke: #ccc;\n}\nsvg .stroke {\n  fill: none;\n  stroke: #ccc;\n}\nsvg .strokeFill {\n  fill: #fff;\n  stroke: #ccc;\n}\n\n.toolbar.active svg .fill {\n  fill: #000;\n  stroke: #000;\n}\n.toolbar.active svg .stroke {\n  fill: none;\n  stroke: #000;\n}\n.toolbar.active svg .strokeFill {\n  fill: #fff;\n  stroke: #000;\n}\n\n.toolbar button {\n    background: #fff;\n    color: #000;\n    border: 1px #ccc;\n    border-style: solid solid solid none;\n    padding: 5;\n    margin: 0;\n    vertical-align: middle;\n    height: 22px;\n}\n\n.toolbar button:active:hover {\n  background: linear-gradient(to bottom, #7abcff 0%,#0052cc 100%,#4096ee 100%);\n}\n\n.toolbar button.left {\n    border-style: solid;\n    border-radius: 3px 0 0 3px;\n}\n\n.toolbar button.right {\n    border: 1px #ccc;\n    border-style: solid solid solid none;\n    border-radius: 0 3px 3px 0;\n}\n\n.toolbar button.active {\n    background: linear-gradient(to bottom, #7abcff 0%,#0052cc 100%,#4096ee 100%);\n    border: 1px #0052cc solid;\n    color: #fff;\n}\n\ndiv.textarea {\n  font-family: var(--toad-font-family, sans-serif);\n  font-size: var(--toad-font-size, 12px);\n  border: 1px #ccc solid;\n  border-radius: 3px;\n  margin: 2px;\n  padding: 4px 5px;\n  outline-offset: -2px;\n}\n\ndiv.textarea h1 {\n  font-size: 22px;\n  margin: 0;\n  padding: 4px 0 4px 0;\n}\n\ndiv.textarea h2 {\n  font-size: 18px;\n  margin: 0;\n  padding: 4px 0 4px 0;\n}\n\ndiv.textarea h3 {\n  font-size: 16px;\n  margin: 0;\n  padding: 4px 0 4px 0;\n}\n\ndiv.textarea h4 {\n  font-size: 14px;\n  margin: 0;\n  padding: 4px 0 4px 0;\n}\n\ndiv.textarea div {\n  padding: 2px 0 2px 0;\n}\n`;\n//# sourceMappingURL=textAreaStyle.js.map","import { jsx as _jsx, jsxs as _jsxs } from \"toad.jsx/lib/jsx-runtime\";\nimport { ModelView } from \"./ModelView.js\";\nimport { textAreaStyle } from \"./textAreaStyle.js\";\nexport class TextTool extends ModelView {\n    constructor() {\n        super();\n        TextTool.texttool = this;\n        let toolbar = _jsx(\"div\", { class: \"toolbar\" }, void 0);\n        this.buttonH1 = _jsx(\"button\", { class: \"left\", children: \"H1\" }, void 0);\n        this.buttonH1.onclick = () => {\n            document.execCommand(\"formatBlock\", false, \"<h1>\");\n            this.update();\n        };\n        toolbar.appendChild(this.buttonH1);\n        this.buttonH2 = _jsx(\"button\", { children: \"H2\" }, void 0);\n        this.buttonH2.onclick = () => {\n            document.execCommand(\"formatBlock\", false, \"<h2>\");\n            this.update();\n        };\n        toolbar.appendChild(this.buttonH2);\n        this.buttonH3 = _jsx(\"button\", { children: \"H3\" }, void 0);\n        this.buttonH3.onclick = () => {\n            document.execCommand(\"formatBlock\", false, \"<h3>\");\n            this.update();\n        };\n        toolbar.appendChild(this.buttonH3);\n        this.buttonH4 = _jsx(\"button\", { class: \"right\", children: \"H4\" }, void 0);\n        this.buttonH4.onclick = () => {\n            document.execCommand(\"formatBlock\", false, \"<h4>\");\n            this.update();\n        };\n        toolbar.appendChild(this.buttonH4);\n        toolbar.appendChild(document.createTextNode(\" \"));\n        this.buttonBold = _jsx(\"button\", { class: \"left\", children: _jsx(\"b\", { children: \"B\" }, void 0) }, void 0);\n        this.buttonBold.onclick = () => {\n            document.execCommand(\"bold\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonBold);\n        this.buttonItalic = _jsx(\"button\", { children: _jsx(\"i\", { children: \"I\" }, void 0) }, void 0);\n        this.buttonItalic.onclick = () => {\n            document.execCommand(\"italic\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonItalic);\n        this.buttonUnderline = _jsx(\"button\", { children: _jsx(\"u\", { children: \"U\" }, void 0) }, void 0);\n        this.buttonUnderline.onclick = () => {\n            document.execCommand(\"underline\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonUnderline);\n        this.buttonStrikeThrough = _jsx(\"button\", { children: _jsx(\"strike\", { children: \"S\" }, void 0) }, void 0);\n        this.buttonStrikeThrough.onclick = () => {\n            document.execCommand(\"strikeThrough\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonStrikeThrough);\n        this.buttonSubscript = _jsx(\"button\", { children: \"x\\u2082\" }, void 0);\n        this.buttonSubscript.onclick = () => {\n            document.execCommand(\"subscript\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonSubscript);\n        this.buttonSuperscript = _jsx(\"button\", { class: \"right\", children: \"x\\u00B2\" }, void 0);\n        this.buttonSuperscript.onclick = () => {\n            document.execCommand(\"superscript\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonSuperscript);\n        toolbar.appendChild(document.createTextNode(\" \"));\n        this.buttonJustifyLeft = _jsx(\"button\", { class: \"left\", children: _jsxs(\"svg\", { viewBox: \"0 0 10 9\", width: \"10\", height: \"9\", children: [_jsx(\"line\", { x1: \"0\", y1: \"0.5\", x2: \"10\", y2: \"0.5\", stroke: \"#000\" }, void 0), _jsx(\"line\", { x1: \"0\", y1: \"2.5\", x2: \"6\", y2: \"2.5\", stroke: \"#000\" }, void 0), _jsx(\"line\", { x1: \"0\", y1: \"4.5\", x2: \"10\", y2: \"4.5\", stroke: \"#000\" }, void 0), _jsx(\"line\", { x1: \"0\", y1: \"6.5\", x2: \"6\", y2: \"6.5\", stroke: \"#000\" }, void 0), _jsx(\"line\", { x1: \"0\", y1: \"8.5\", x2: \"10\", y2: \"8.5\", stroke: \"#000\" }, void 0)] }, void 0) }, void 0);\n        this.buttonJustifyLeft.onclick = () => {\n            document.execCommand(\"justifyLeft\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonJustifyLeft);\n        this.buttonJustifyCenter = _jsx(\"button\", { children: _jsxs(\"svg\", { viewBox: \"0 0 10 9\", width: \"10\", height: \"9\", children: [_jsx(\"line\", { x1: \"0\", y1: \"0.5\", x2: \"10\", y2: \"0.5\", stroke: \"#000\" }, void 0), _jsx(\"line\", { x1: \"2\", y1: \"2.5\", x2: \"8\", y2: \"2.5\", stroke: \"#000\" }, void 0), _jsx(\"line\", { x1: \"0\", y1: \"4.5\", x2: \"10\", y2: \"4.5\", stroke: \"#000\" }, void 0), _jsx(\"line\", { x1: \"2\", y1: \"6.5\", x2: \"8\", y2: \"6.5\", stroke: \"#000\" }, void 0), _jsx(\"line\", { x1: \"0\", y1: \"8.5\", x2: \"10\", y2: \"8.5\", stroke: \"#000\" }, void 0)] }, void 0) }, void 0);\n        this.buttonJustifyCenter.onclick = () => {\n            document.execCommand(\"justifyCenter\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonJustifyCenter);\n        this.buttonJustifyRight = _jsx(\"button\", { class: \"right\", children: _jsxs(\"svg\", { viewBox: \"0 0 10 9\", width: \"10\", height: \"9\", children: [_jsx(\"line\", { x1: \"0\", y1: \"0.5\", x2: \"10\", y2: \"0.5\", stroke: \"#000\" }, void 0), _jsx(\"line\", { x1: \"4\", y1: \"2.5\", x2: \"10\", y2: \"2.5\", stroke: \"#000\" }, void 0), _jsx(\"line\", { x1: \"0\", y1: \"4.5\", x2: \"10\", y2: \"4.5\", stroke: \"#000\" }, void 0), _jsx(\"line\", { x1: \"4\", y1: \"6.5\", x2: \"10\", y2: \"6.5\", stroke: \"#000\" }, void 0), _jsx(\"line\", { x1: \"0\", y1: \"8.5\", x2: \"10\", y2: \"8.5\", stroke: \"#000\" }, void 0)] }, void 0) }, void 0);\n        this.buttonJustifyRight.onclick = () => {\n            document.execCommand(\"justifyRight\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonJustifyRight);\n        this.buttonUnorderedList = _jsx(\"button\", { class: \"left\", children: _jsxs(\"svg\", { style: { display: \"block\" }, viewBox: \"0 0 17 11.5\", width: \"17\", height: \"11.5\", children: [_jsx(\"circle\", { cx: \"4.5\", cy: \"1.5\", r: \"0.8\", stroke: \"#000\", fill: \"#000\" }, void 0), _jsx(\"line\", { x1: \"7\", y1: \"1.5\", x2: \"17\", y2: \"1.5\", stroke: \"#000\" }, void 0), _jsx(\"circle\", { cx: \"4.5\", cy: \"5.5\", r: \"0.8\", stroke: \"#000\", fill: \"#000\" }, void 0), _jsx(\"line\", { x1: \"7\", y1: \"5.5\", x2: \"17\", y2: \"5.5\", stroke: \"#000\" }, void 0), _jsx(\"circle\", { cx: \"4.5\", cy: \"9.5\", r: \"0.8\", stroke: \"#000\", fill: \"#000\" }, void 0), _jsx(\"line\", { x1: \"7\", y1: \"9.5\", x2: \"17\", y2: \"9.5\", stroke: \"#000\" }, void 0)] }, void 0) }, void 0);\n        this.buttonUnorderedList.onclick = (event) => {\n            document.execCommand(\"insertUnorderedList\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonUnorderedList);\n        this.buttonOrderedList = _jsx(\"button\", { class: \"right\", children: _jsxs(\"svg\", { style: { display: \"block\" }, viewBox: \"0 0 17 11.5\", width: \"17\", height: \"11.5\", children: [_jsx(\"line\", { x1: \"4.5\", y1: \"0\", x2: \"4.5\", y2: \"3\", stroke: \"#000\" }, void 0), _jsx(\"line\", { x1: \"7\", y1: \"1.5\", x2: \"17\", y2: \"1.5\", stroke: \"#000\" }, void 0), _jsx(\"line\", { x1: \"2.5\", y1: \"4\", x2: \"2.5\", y2: \"7\", stroke: \"#000\" }, void 0), _jsx(\"line\", { x1: \"4.5\", y1: \"4\", x2: \"4.5\", y2: \"7\", stroke: \"#000\" }, void 0), _jsx(\"line\", { x1: \"7\", y1: \"5.5\", x2: \"17\", y2: \"5.5\", stroke: \"#000\" }, void 0), _jsx(\"line\", { x1: \"0.5\", y1: \"8\", x2: \"0.5\", y2: \"11\", stroke: \"#000\" }, void 0), _jsx(\"line\", { x1: \"2.5\", y1: \"8\", x2: \"2.5\", y2: \"11\", stroke: \"#000\" }, void 0), _jsx(\"line\", { x1: \"4.5\", y1: \"8\", x2: \"4.5\", y2: \"11\", stroke: \"#000\" }, void 0), _jsx(\"line\", { x1: \"7\", y1: \"9.5\", x2: \"17\", y2: \"9.5\", stroke: \"#000\" }, void 0)] }, void 0) }, void 0);\n        this.buttonOrderedList.onclick = () => {\n            document.execCommand(\"insertOrderedList\", false);\n            this.update();\n        };\n        toolbar.appendChild(this.buttonOrderedList);\n        this.attachShadow({ mode: 'open' });\n        this.shadowRoot.appendChild(document.importNode(textAreaStyle, true));\n        this.shadowRoot.appendChild(toolbar);\n    }\n    update() {\n        this.buttonH1.classList.toggle(\"active\", document.queryCommandValue(\"formatBlock\") === \"h1\");\n        this.buttonH2.classList.toggle(\"active\", document.queryCommandValue(\"formatBlock\") === \"h2\");\n        this.buttonH3.classList.toggle(\"active\", document.queryCommandValue(\"formatBlock\") === \"h3\");\n        this.buttonH4.classList.toggle(\"active\", document.queryCommandValue(\"formatBlock\") === \"h4\");\n        this.buttonBold.classList.toggle(\"active\", document.queryCommandState(\"bold\"));\n        this.buttonItalic.classList.toggle(\"active\", document.queryCommandState(\"italic\"));\n        this.buttonUnderline.classList.toggle(\"active\", document.queryCommandState(\"underline\"));\n        this.buttonStrikeThrough.classList.toggle(\"active\", document.queryCommandState(\"strikeThrough\"));\n        this.buttonSubscript.classList.toggle(\"active\", document.queryCommandState(\"subscript\"));\n        this.buttonSuperscript.classList.toggle(\"active\", document.queryCommandState(\"superscript\"));\n        this.buttonJustifyLeft.classList.toggle(\"active\", document.queryCommandState(\"justifyLeft\"));\n        this.buttonJustifyCenter.classList.toggle(\"active\", document.queryCommandState(\"justifyCenter\"));\n        this.buttonJustifyRight.classList.toggle(\"active\", document.queryCommandState(\"justifyRight\"));\n    }\n}\n//# sourceMappingURL=TextTool.js.map","import { HtmlModel } from \"../model/HtmlModel.js\";\nimport { ModelView } from \"./ModelView.js\";\nimport { TextTool } from \"./TextTool.js\";\nimport { textAreaStyle } from \"./textAreaStyle.js\";\nexport class TextArea extends ModelView {\n    constructor() {\n        super();\n        let content = document.createElement(\"div\");\n        this.content = content;\n        content.classList.add(\"textarea\");\n        content.contentEditable = \"true\";\n        content.oninput = (event) => {\n            if (this.model instanceof HtmlModel) {\n                let firstChild = event.target.firstChild;\n                if (firstChild && firstChild.nodeType === 3) {\n                    document.execCommand(\"formatBlock\", false, `<div>`);\n                }\n                else if (content.innerHTML === \"<br>\") {\n                    content.innerHTML = \"\";\n                }\n            }\n            this.updateModel();\n        };\n        content.onkeydown = (event) => {\n            if (!(this.model instanceof HtmlModel)) {\n                return;\n            }\n            if (event.metaKey === true && event.key === \"b\") {\n                event.preventDefault();\n                document.execCommand(\"bold\", false);\n                this.updateTextTool();\n            }\n            else if (event.metaKey === true && event.key === \"i\") {\n                event.preventDefault();\n                document.execCommand(\"italic\", false);\n                this.updateTextTool();\n            }\n            else if (event.metaKey === true && event.key === \"u\") {\n                event.preventDefault();\n                document.execCommand(\"underline\", false);\n                this.updateTextTool();\n            }\n            else if (event.key === \"Tab\") {\n                event.preventDefault();\n            }\n            else if (event.key === \"Enter\" &&\n                event.shiftKey !== true &&\n                document.queryCommandValue(\"formatBlock\") === \"blockquote\") {\n                document.execCommand(\"formatBlock\", false, \"<p>\");\n            }\n        };\n        content.onkeyup = () => {\n            this.updateTextTool();\n        };\n        content.onmouseup = () => {\n            this.updateTextTool();\n        };\n        this.attachShadow({ mode: 'open' });\n        this.shadowRoot.appendChild(document.importNode(textAreaStyle, true));\n        this.shadowRoot.appendChild(content);\n    }\n    updateTextTool() {\n        if (TextTool.texttool !== undefined)\n            TextTool.texttool.update();\n    }\n    updateModel() {\n        if (this.model) {\n            this.model.promise = () => {\n                if (this.model instanceof HtmlModel) {\n                    return this.content.innerHTML;\n                }\n                else {\n                    return this.content.innerText;\n                }\n            };\n        }\n    }\n    updateView() {\n        if (!this.model) {\n            return;\n        }\n        if (this.model instanceof HtmlModel) {\n            if (this.content.innerHTML !== this.model.value) {\n                this.content.innerHTML = this.model.value;\n            }\n        }\n        else {\n            if (this.content.innerText !== this.model.value) {\n                this.content.innerText = this.model.value;\n            }\n        }\n    }\n}\n//# sourceMappingURL=TextArea.js.map","import { View } from \"./View.js\";\nexport class GenericTool extends View {\n    static focusIn(view) {\n        const viewParents = new Map();\n        for (let parent = view.parentElement, distance = 0; parent !== null; parent = parent.parentElement, ++distance) {\n            viewParents.set(parent, distance);\n        }\n        let closestToolDistance = Number.MAX_SAFE_INTEGER;\n        let closestParent;\n        let closestToolList = new Array();\n        for (const tool of this.allTools.values()) {\n            if (!tool.canHandle(view))\n                continue;\n            for (let toolParent = tool.parentElement, depth = 0; toolParent !== null; toolParent = toolParent.parentElement, ++depth) {\n                const toolDistance = viewParents.get(toolParent);\n                if (toolDistance === undefined)\n                    continue;\n                if (closestToolDistance < toolDistance)\n                    continue;\n                if (closestToolDistance > toolDistance) {\n                    closestToolList.length = 0;\n                }\n                closestToolDistance = toolDistance;\n                closestParent = toolParent;\n                closestToolList.push(tool);\n            }\n        }\n        if (!closestParent) {\n            return;\n        }\n        let closestTool;\n        const viewIndex = GenericTool.getIndex(view, closestParent);\n        let closestNextSiblingIndex = Number.MIN_SAFE_INTEGER;\n        for (let tool of closestToolList) {\n            const toolIndex = GenericTool.getIndex(tool, closestParent);\n            if (toolIndex < viewIndex && toolIndex > closestNextSiblingIndex) {\n                closestNextSiblingIndex = toolIndex;\n                closestTool = tool;\n            }\n        }\n        this.setActive(closestTool, view);\n    }\n    static getIndex(view, parent) {\n        if (parent === undefined) {\n            console.trace(`GenericTool.getIndex(${view}, ${parent})`);\n        }\n        let element = view;\n        while (element.parentElement !== parent)\n            element = element.parentElement;\n        return Array.from(parent.childNodes).indexOf(element);\n    }\n    static setActive(tool, view) {\n        if (this.activeTool)\n            this.activeTool.deactivate();\n        this.activeTool = tool;\n        this.activeView = view;\n        if (tool)\n            tool.activate();\n    }\n    static focusOut(view) {\n        if (this.activeView === view) {\n            this.setActive(undefined, undefined);\n        }\n    }\n    connectedCallback() {\n        super.connectedCallback();\n        GenericTool.allTools.add(this);\n    }\n    disconnectedCallback() {\n        if (GenericTool.activeTool === this) {\n            GenericTool.setActive(undefined, undefined);\n        }\n        GenericTool.allTools.delete(this);\n        super.disconnectedCallback();\n    }\n}\nGenericTool.allTools = new Set();\nwindow.addEventListener(\"focusin\", (event) => {\n    if (event.target instanceof GenericTool)\n        return;\n    if (event.relatedTarget instanceof View) {\n        GenericTool.focusOut(event.relatedTarget);\n    }\n    if (event.target instanceof View) {\n        GenericTool.focusIn(event.target);\n    }\n});\n//# sourceMappingURL=GenericTool.js.map","import { ModelView } from \"./ModelView.js\";\nlet toolbuttonStyle = document.createElement(\"style\");\ntoolbuttonStyle.textContent = `\ndiv {\n    border: 1px solid #e3dbdb;\n    border-radius: 5px;\n    background: #e3dbdb;\n    width: 32px;\n    height: 32px;\n    padding: 3px;\n}\n\n:host([selected]) div {\n    background: #ac9393;\n}\n\n:host([disabled]) div {\n    opacity: 0.5;\n}\n\n:host([disabled]) div img {\n    opacity: 0.5;\n}\n\n:host([checked][disabled]) div {\n}\n`;\nexport class ToolButton extends ModelView {\n    constructor(init) {\n        super();\n        if (!init) {\n            init = {\n                value: this.getAttribute(\"value\"),\n                img: this.getAttribute(\"img\"),\n                disabled: this.hasAttribute(\"disabled\")\n            };\n        }\n        else {\n            this.setAttribute(\"value\", init.value);\n            this.setAttribute(\"img\", init.img);\n            if (init.disabled === true)\n                this.setAttribute(\"disabled\", \"disabled\");\n        }\n        if (init.model)\n            this.setModel(init.model);\n        let button = document.createElement(\"div\");\n        button.onmousedown = (event) => {\n            if (this.hasAttribute(\"disabled\"))\n                return;\n            button.focus();\n            event.preventDefault();\n            if (this.model !== undefined)\n                this.model.stringValue = this.getValue();\n        };\n        let img = document.createElement(\"img\");\n        img.src = init.img;\n        button.appendChild(img);\n        this.attachShadow({ mode: 'open' });\n        this.shadowRoot.appendChild(document.importNode(toolbuttonStyle, true));\n        this.shadowRoot.appendChild(button);\n    }\n    getValue() {\n        let value = this.getAttribute(\"value\");\n        if (value === null)\n            throw Error(\"no value\");\n        return value;\n    }\n    connectedCallback() {\n        super.connectedCallback();\n        if (this.model === undefined)\n            this.setAttribute(\"disabled\", \"\");\n    }\n    updateView() {\n        if (this.model === undefined) {\n            this.setAttribute(\"disabled\", \"\");\n            this.removeAttribute(\"selected\");\n            return;\n        }\n        let value = this.getValue();\n        if (this.model.isValidStringValue(value)) {\n            this.removeAttribute(\"disabled\");\n        }\n        else {\n            this.setAttribute(\"disabled\", \"\");\n        }\n        if (this.model.stringValue === value) {\n            this.setAttribute(\"selected\", \"\");\n        }\n        else {\n            this.removeAttribute(\"selected\");\n        }\n    }\n}\n//# sourceMappingURL=ToolButton.js.map","import { HtmlModel } from \"../model/HtmlModel.js\";\nimport { ModelView } from \"./ModelView.js\";\nexport class SlotView extends ModelView {\n    constructor() { super(); }\n    updateView() {\n        if (!this.model)\n            return;\n        let value = this.model.value === undefined ? \"\" : this.model.value;\n        if (this.model instanceof HtmlModel)\n            this.innerHTML = value;\n        else\n            this.innerText = value;\n    }\n}\n//# sourceMappingURL=SlotView.js.map","import { ModelView } from \"./ModelView.js\";\nexport class ToadIf extends ModelView {\n    updateView() {\n        if (this.model) {\n            this.style.display = this.model.value ? \"\" : \"none\";\n        }\n    }\n}\n//# sourceMappingURL=ToadIf.js.map","export const menuStyle = document.createElement(\"style\");\nmenuStyle.textContent = `\n  :host(.menu-button) {\n    font-family: var(--toad-font-family, sans-serif);\n    font-size: 14px;\n    font-weight: bold;\n    padding: 7px;\n    vertical-align: center;\n  \n    background: #fff;\n    color: #000;\n    cursor: default;\n  }\n  :host(.menu-button.active) {\n    background: #000;\n    color: #fff;\n  }\n  :host(.menu-button.disabled) {\n    color: #888;\n  }\n  :host(.menu-button.active.disabled) {\n    color: #888;\n  }\n  :host(.menu-button.menu-down) {\n    padding-right: 20px;\n    background-image: url(\"data:image/svg+xml;base64,${btoa('<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"14\"><path d=\"M 0 4 l 10 0 l -5 5 Z\" fill=\"#000\" stroke=\"none\"/></svg>')}\");\n    background-repeat: no-repeat;\n    background-position: right center;\n  }\n  :host(.menu-button.active.menu-down) {\n    background-image: url(\"data:image/svg+xml;base64,${btoa('<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"14\"><path d=\"M 0 4 l 10 0 l -5 5 Z\" fill=\"#fff\" stroke=\"none\"/></svg>')}\");\n    background-repeat: no-repeat;\n    background-position: right center;\n  }\n  :host(.menu-button.menu-side) {\n    padding-right: 20px;\n    background-image: url(\"data:image/svg+xml;base64,${btoa('<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"14\"><path d=\"M 0 2 l 0 10 l 5 -5 Z\" fill=\"#000\" stroke=\"none\"/></svg>')}\");\n    background-repeat: no-repeat;\n    background-position: right center;\n  }\n  :host(.menu-button.active.menu-side) {\n    background-image: url(\"data:image/svg+xml;base64,${btoa('<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"15\" height=\"14\"><path d=\"M 0 2 l 0 10 l 5 -5 Z\" fill=\"#fff\" stroke=\"none\"/></svg>')}\");\n    background-repeat: no-repeat;\n    background-position: right center;\n  }\n  .menu-bar {\n    display: flex;\n    flex-direction: row;\n    justify-content: flex-start;\n    align-items: center;\n  }\n  .menu-popup {\n    position: fixed;\n    display: flex;\n    flex-direction: column;\n    box-shadow: 2px 2px 5px #888;\n  }\n`;\n//# sourceMappingURL=menuStyle.js.map","export var MenuState;\n(function (MenuState) {\n    MenuState[MenuState[\"WAIT\"] = 0] = \"WAIT\";\n    MenuState[MenuState[\"DOWN\"] = 1] = \"DOWN\";\n    MenuState[MenuState[\"UP_N_HOLD\"] = 2] = \"UP_N_HOLD\";\n    MenuState[MenuState[\"DOWN_N_HOLD\"] = 3] = \"DOWN_N_HOLD\";\n    MenuState[MenuState[\"DOWN_N_OUTSIDE\"] = 4] = \"DOWN_N_OUTSIDE\";\n    MenuState[MenuState[\"DOWN_N_INSIDE_AGAIN\"] = 5] = \"DOWN_N_INSIDE_AGAIN\";\n})(MenuState || (MenuState = {}));\n//# sourceMappingURL=MenuState.js.map","import { View } from \"../view/View.js\";\nimport { MenuState } from \"./MenuState.js\";\nexport class MenuButtonContainer extends View {\n    constructor(props) {\n        super(props);\n        this.vertical = true;\n        this.closeOnClose = false;\n        this.state = MenuState.WAIT;\n    }\n}\n//# sourceMappingURL=MenuHelper.js.map","import { View } from \"../view/View.js\";\nimport { MenuButtonContainer } from \"./MenuHelper.js\";\nexport class PopupMenu extends MenuButtonContainer {\n    constructor(root, parent) {\n        super();\n        this.vertical = true;\n        this.root = root;\n        this.parentButton = parent;\n        this.popup = document.createElement(\"div\");\n        this.popup.classList.add(\"menu-popup\");\n        let node = root.down;\n        while (node) {\n            if (node.isAvailable()) {\n                node.createWindowAt(this, this.popup);\n            }\n            else {\n                node.deleteWindow();\n            }\n            node = node.next;\n        }\n        this.appendChild(this.popup);\n        this.show();\n    }\n    show() {\n        if (!this.parentButton.master.vertical)\n            placePopupVertical(this.parentButton, this.popup);\n        else\n            placePopupHorizontal(this.parentButton, this.popup);\n        this.style.display = \"\";\n    }\n    hide() {\n        this.style.display = \"none\";\n    }\n}\nView.define(\"toad-popupmenu\", PopupMenu);\nexport function placePopupVertical(parent, popup) {\n    let parentBoundary = parent.getBoundingClientRect();\n    popup.style.opacity = \"0\";\n    popup.style.left = parentBoundary.left + \"px\";\n    popup.style.top = (parentBoundary.top + parentBoundary.height) + \"px\";\n    setTimeout(function () {\n        let popupBoundary = popup.getBoundingClientRect();\n        let popupBottom = parentBoundary.top + parentBoundary.height + popupBoundary.height;\n        if (popupBottom > window.innerHeight) {\n            popup.style.top = (parentBoundary.top - popupBoundary.height) + \"px\";\n        }\n        let popupRight = parentBoundary.left + popupBoundary.width;\n        if (popupRight > window.innerWidth) {\n            popup.style.left = (parentBoundary.left + parentBoundary.width - popupBoundary.width) + \"px\";\n        }\n        popup.style.opacity = \"1\";\n    }, 0);\n}\nexport function placePopupHorizontal(parent, popup) {\n    let parentBoundary = parent.getBoundingClientRect();\n    popup.style.opacity = \"0\";\n    popup.style.left = (parentBoundary.left + parentBoundary.width) + \"px\";\n    popup.style.top = parentBoundary.top + \"px\";\n    setTimeout(function () {\n        let popupBoundary = popup.getBoundingClientRect();\n        let popupBottom = parentBoundary.top + popupBoundary.height;\n        if (popupBottom > window.innerHeight) {\n            popup.style.top = (parentBoundary.top + parentBoundary.height - popupBoundary.height) + \"px\";\n        }\n        let popupRight = parentBoundary.left + parentBoundary.width + popupBoundary.width;\n        if (popupRight > window.innerWidth) {\n            popup.style.left = (parentBoundary.left - popupBoundary.width) + \"px\";\n        }\n        popup.style.opacity = \"1\";\n    }, 0);\n}\n//# sourceMappingURL=PopupMenu.js.map","import { Action } from \"../model/Action.js\";\nimport { HtmlModel } from \"../model/HtmlModel.js\";\nimport { TextModel } from \"../model/TextModel.js\";\nimport { ModelView } from \"../view/ModelView.js\";\nimport { globalController } from \"../controller/globalController.js\";\nimport { menuStyle } from \"./menuStyle.js\";\nimport { MenuState } from \"./MenuState.js\";\nimport { PopupMenu } from \"./PopupMenu.js\";\nexport class MenuButton extends ModelView {\n    constructor(master, node) {\n        super();\n        this.master = master;\n        this.node = node;\n        let menuButton = this;\n        this.classList.add(\"menu-button\");\n        if (node.down) {\n            if (master.vertical)\n                this.classList.add(\"menu-side\");\n            else\n                this.classList.add(\"menu-down\");\n        }\n        this.updateView();\n        this.onmousedown = (event) => {\n            event.stopPropagation();\n            let documentMouseUp = function (event) {\n                document.removeEventListener(\"mouseup\", documentMouseUp, { capture: true });\n                event.preventDefault();\n                setTimeout(() => {\n                    if (MenuButton.buttonDown)\n                        menuButton.dispatchEvent(new MouseEvent(\"mouseup\", event));\n                }, 0);\n            };\n            document.addEventListener(\"mouseup\", documentMouseUp, { capture: true });\n            MenuButton.buttonDown = true;\n            if (!this.master)\n                throw Error(\"yikes\");\n            switch (this.master.state) {\n                case MenuState.WAIT:\n                    this.master.state = MenuState.DOWN;\n                    this.activate();\n                    break;\n                case MenuState.UP_N_HOLD:\n                    if (this.master.active !== this) {\n                        this.master.state = MenuState.DOWN;\n                        this.activate();\n                    }\n                    else {\n                        this.master.state = MenuState.DOWN_N_HOLD;\n                    }\n                    break;\n                default:\n                    throw Error(\"unexpected state \" + this.master.state);\n            }\n            return false;\n        };\n        this.onmouseup = (event) => {\n            event.stopPropagation();\n            if (!MenuButton.buttonDown)\n                return;\n            MenuButton.buttonDown = false;\n            if (!this.master)\n                throw Error(\"yikes\");\n            if (!this.node)\n                throw Error(\"yikes\");\n            switch (this.master.state) {\n                case MenuState.DOWN:\n                    if (this.node.isEnabled() && !this.node.down) {\n                        this.trigger();\n                        this.master.state = MenuState.WAIT;\n                    }\n                    else {\n                        this.master.state = MenuState.UP_N_HOLD;\n                        if (MenuButton.documentMouseDown) {\n                            document.removeEventListener(\"mousedown\", MenuButton.documentMouseDown, { capture: false });\n                        }\n                        MenuButton.documentMouseDown = function (event) {\n                            if (MenuButton.documentMouseDown)\n                                document.removeEventListener(\"mousedown\", MenuButton.documentMouseDown, { capture: false });\n                            MenuButton.documentMouseDown = undefined;\n                            let tagName = event.target.tagName;\n                            if (tagName !== \"TOAD-MENUBUTTON\") {\n                                menuButton.collapse();\n                            }\n                        };\n                        document.addEventListener(\"mousedown\", MenuButton.documentMouseDown, { capture: false });\n                    }\n                    break;\n                case MenuState.DOWN_N_HOLD:\n                case MenuState.DOWN_N_OUTSIDE:\n                    this.master.state = MenuState.WAIT;\n                    this.deactivate();\n                    this.collapse();\n                    if (this.master.closeOnClose) {\n                    }\n                    break;\n                case MenuState.DOWN_N_INSIDE_AGAIN:\n                    this.trigger();\n                    break;\n                default:\n                    throw Error(\"unexpected state \" + this.master.state);\n            }\n            return false;\n        };\n        this.onmouseout = (event) => {\n            event.stopPropagation();\n            if (!this.master)\n                throw Error(\"yikes\");\n            MenuButton.inside = undefined;\n            switch (this.master.state) {\n                case MenuState.WAIT:\n                case MenuState.DOWN_N_OUTSIDE:\n                case MenuState.UP_N_HOLD:\n                case MenuState.DOWN_N_HOLD:\n                    break;\n                case MenuState.DOWN:\n                case MenuState.DOWN_N_INSIDE_AGAIN:\n                    this.master.state = MenuState.DOWN_N_OUTSIDE;\n                    this.updateView();\n                    break;\n                default:\n                    throw Error(\"unexpected state\");\n            }\n            return false;\n        };\n        this.onmouseover = (event) => {\n            event.stopPropagation();\n            if (!menuButton.master)\n                throw Error(\"yikes\");\n            MenuButton.inside = menuButton;\n            switch (menuButton.master.state) {\n                case MenuState.WAIT:\n                case MenuState.UP_N_HOLD:\n                case MenuState.DOWN_N_OUTSIDE:\n                case MenuState.DOWN_N_HOLD:\n                case MenuState.DOWN:\n                case MenuState.DOWN_N_INSIDE_AGAIN:\n                    if (!MenuButton.buttonDown)\n                        break;\n                    if (!this.master)\n                        throw Error(\"yikes\");\n                    if (this.master.active)\n                        this.master.active.deactivate();\n                    this.master.state = MenuState.DOWN_N_INSIDE_AGAIN;\n                    this.activate();\n                    break;\n                default:\n                    throw Error(\"unexpected state \" + menuButton.master.state);\n            }\n            return false;\n        };\n        this.attachShadow({ mode: 'open' });\n        if (!this.shadowRoot)\n            throw Error(\"yikes\");\n        this.shadowRoot.appendChild(document.importNode(menuStyle, true));\n        if (!this.node.modelId)\n            this.shadowRoot.appendChild(document.createTextNode(node.label));\n    }\n    connectedCallback() {\n        if (this.controller)\n            return;\n        if (this.node.down === undefined) {\n            let actionId = this.node.title;\n            for (let node = this.node.parent; node; node = node.parent) {\n                if (!node.title.length)\n                    break;\n                actionId = node.title + \"|\" + actionId;\n            }\n            actionId = \"A:\" + actionId;\n            globalController.registerView(actionId, this);\n        }\n        if (this.node.modelId !== undefined) {\n            if (typeof this.node.modelId === \"string\") {\n                let modelId = \"M:\" + this.node.modelId;\n                globalController.registerView(modelId, this);\n            }\n            else {\n                this.setModel(this.node.modelId);\n            }\n        }\n    }\n    disconnectedCallback() {\n        if (this.controller)\n            this.controller.unregisterView(this);\n    }\n    setModel(model) {\n        if (!model) {\n            if (this.action)\n                this.action.modified.remove(this);\n            this.model = undefined;\n            this.action = undefined;\n            this.updateView();\n            return;\n        }\n        if (model instanceof Action) {\n            this.action = model;\n            this.action.modified.add(() => {\n                this.updateView();\n            }, this);\n        }\n        else if (model instanceof TextModel) {\n            this.model = model;\n        }\n        else {\n            throw Error(\"unexpected model of type \" + model.constructor.name);\n        }\n        this.updateView();\n    }\n    updateView() {\n        if (this.model && this.model.value) {\n            if (!this.shadowRoot)\n                throw Error(\"yikes\");\n            let span = document.createElement(\"span\");\n            if (this.model instanceof HtmlModel)\n                span.innerHTML = this.model.value;\n            else\n                span.innerText = this.model.value;\n            if (this.shadowRoot.children.length > 1)\n                this.shadowRoot.removeChild(this.shadowRoot.children[1]);\n            if (this.shadowRoot.children.length > 1)\n                this.shadowRoot.insertBefore(span, this.shadowRoot.children[1]);\n            else\n                this.shadowRoot.appendChild(span);\n        }\n        if (!this.master)\n            throw Error(\"yikes\");\n        let active = false;\n        if (this.master.active == this) {\n            switch (this.master.state) {\n                case MenuState.DOWN:\n                case MenuState.UP_N_HOLD:\n                case MenuState.DOWN_N_HOLD:\n                case MenuState.DOWN_N_INSIDE_AGAIN:\n                    active = true;\n                    break;\n                case MenuState.DOWN_N_OUTSIDE:\n                    if (!this.node)\n                        throw Error(\"yikes\");\n                    active = this.node.down !== undefined && this.node.isEnabled();\n                    break;\n            }\n        }\n        this.classList.toggle(\"active\", active);\n        this.classList.toggle(\"disabled\", !this.isEnabled());\n    }\n    isEnabled() {\n        if (this.node.down !== undefined)\n            return true;\n        return this.action !== undefined && this.action.enabled;\n    }\n    trigger() {\n        this.collapse();\n        if (!this.action)\n            return;\n        this.action.trigger();\n    }\n    collapse() {\n        if (!this.master)\n            throw Error(\"yikes\");\n        if (this.master.parentButton)\n            this.master.parentButton.collapse();\n        else\n            this.deactivate();\n    }\n    openPopup() {\n        if (!this.node)\n            return;\n        if (!this.node.down)\n            return;\n        if (!this.shadowRoot)\n            throw Error(\"yikes\");\n        if (!this.popup) {\n            this.popup = new PopupMenu(this.node, this);\n            this.shadowRoot.appendChild(this.popup);\n        }\n        else {\n            this.popup.show();\n        }\n    }\n    closePopup() {\n        if (!this.popup)\n            return;\n        if (this.popup.active)\n            this.popup.active.deactivate();\n        this.popup.hide();\n    }\n    activate() {\n        if (!this.master)\n            throw Error(\"yikes\");\n        if (!this.node)\n            throw Error(\"yikes\");\n        let oldActive = this.master.active;\n        this.master.active = this;\n        if (oldActive && oldActive !== this) {\n            oldActive.closePopup();\n            oldActive.updateView();\n        }\n        this.updateView();\n        this.openPopup();\n    }\n    deactivate() {\n        if (!this.master)\n            throw Error(\"yikes\");\n        if (this.master.active !== this)\n            return;\n        this.master.active.closePopup();\n        this.master.active = undefined;\n        this.master.state = MenuState.WAIT;\n        this.updateView();\n    }\n}\n//# sourceMappingURL=MenuButton.js.map","import { MenuButton } from \"./MenuButton.js\";\nexport class MenuNode {\n    constructor(title, label, shortcut, type, modelId) {\n        this.title = title;\n        this.label = label;\n        this.shortcut = shortcut;\n        this.type = type ? type : \"entry\";\n        this.modelId = modelId;\n    }\n    isEnabled() {\n        return true;\n    }\n    isAvailable() {\n        return true;\n    }\n    createWindowAt(parent, parentView) {\n        if (this.type == \"spacer\") {\n            let span = document.createElement(\"span\");\n            span.style.flexGrow = \"1\";\n            parentView.appendChild(span);\n            return;\n        }\n        this.view = new MenuButton(parent, this);\n        parentView.appendChild(this.view);\n    }\n    deleteWindow() {\n    }\n}\n//# sourceMappingURL=MenuNode.js.map","import * as dom from \"../util/dom.js\";\nimport { MenuNode } from \"./MenuNode.js\";\nimport { MenuButtonContainer } from \"./MenuHelper.js\";\nimport { menuStyle } from \"./menuStyle.js\";\nexport class Menu extends MenuButtonContainer {\n    constructor(props) {\n        super(props);\n        this.config = props?.config;\n        this.vertical = false;\n        this.root = new MenuNode(\"\", \"\", undefined, undefined);\n    }\n    connectedCallback() {\n        super.connectedCallback();\n        this.tabIndex = 0;\n        if (this.config) {\n            this.config2nodes(this.config, this.root);\n            this.referenceActions();\n            this.createShadowDOM();\n            return;\n        }\n        if (this.children.length === 0) {\n            this._observer = new MutationObserver((record, observer) => {\n                if (this._timer !== undefined)\n                    clearTimeout(this._timer);\n                this._timer = window.setTimeout(() => {\n                    this._timer = undefined;\n                    this.layout2nodes(this.children, this.root);\n                    this.referenceActions();\n                    this.createShadowDOM();\n                }, 100);\n            });\n            this._observer.observe(this, {\n                childList: true,\n                subtree: true\n            });\n        }\n        else {\n            this.layout2nodes(this.children, this.root);\n            this.referenceActions();\n            this.createShadowDOM();\n        }\n    }\n    layout2nodes(children, parent) {\n        let node = parent.down;\n        for (let child of children) {\n            let newnode = undefined;\n            switch (child.nodeName) {\n                case \"TOAD-MENUSPACER\":\n                    newnode = new MenuNode(\"\", \"\", \"\", \"spacer\");\n                    break;\n                case \"TOAD-MENUENTRY\":\n                    newnode = new MenuNode(dom.attribute(child, \"name\"), dom.attribute(child, \"label\"), dom.attributeOrUndefined(child, \"shortcut\"), dom.attributeOrUndefined(child, \"type\"), dom.attributeOrUndefined(child, \"model\"));\n                    break;\n            }\n            if (newnode) {\n                newnode.parent = parent;\n                if (!node)\n                    parent.down = newnode;\n                else\n                    node.next = newnode;\n                node = newnode;\n            }\n            if (!node)\n                throw Error(\"yikes\");\n            this.layout2nodes(child.children, node);\n        }\n    }\n    config2nodes(config, parent) {\n        let node = parent.down;\n        for (let child of config) {\n            let newnode = undefined;\n            if (child.space === true) {\n                newnode = new MenuNode(\"\", \"\", \"\", \"spacer\");\n            }\n            else {\n                newnode = new MenuNode(child.name, child.label, child.shortcut, child.type, child.model);\n            }\n            if (newnode) {\n                newnode.parent = parent;\n                if (!node)\n                    parent.down = newnode;\n                else\n                    node.next = newnode;\n                node = newnode;\n            }\n            if (!node)\n                throw Error(\"yikes\");\n            if (child.sub)\n                this.config2nodes(child.sub, node);\n        }\n    }\n    referenceActions() {\n    }\n    findNode(str, parent) {\n        let strpos = str.indexOf(\"|\");\n        let left = strpos == -1 ? str : str.substr(0, strpos);\n        let right = strpos == -1 ? \"\" : str.substr(strpos + 1);\n        if (!parent)\n            parent = this.root;\n        for (let n = parent.down; n; n = n.next) {\n            if (n.title == left) {\n                if (!n.down) {\n                    return n;\n                }\n                return this.findNode(right, n);\n            }\n        }\n        return undefined;\n    }\n    createShadowDOM() {\n        this.view = document.createElement(\"div\");\n        this.view.classList.add(\"menu-bar\");\n        let node = this.root.down;\n        while (node) {\n            if (node.isAvailable()) {\n                node.createWindowAt(this, this.view);\n            }\n            else {\n                node.deleteWindow();\n            }\n            node = node.next;\n        }\n        this.attachShadow({ mode: 'open' });\n        this.shadowRoot.appendChild(document.importNode(menuStyle, true));\n        this.shadowRoot.appendChild(this.view);\n    }\n}\n//# sourceMappingURL=Menu.js.map","export class MenuSpacer extends HTMLElement {\n}\n//# sourceMappingURL=MenuSpacer.js.map","let animationFrameCount = 468;\nexport function setAnimationFrameCount(frames) {\n    animationFrameCount = frames;\n}\nexport function scrollIntoView(element) {\n    if (element === undefined)\n        return;\n    const scrollableParent = findScrollableParent(element);\n    if (scrollableParent === undefined)\n        return;\n    const parentRect = scrollableParent.getBoundingClientRect();\n    const clientRect = element.getBoundingClientRect();\n    if (scrollableParent !== document.body) {\n        const { x, y } = calculateScrollGoal(scrollableParent, parentRect, clientRect);\n        smoothScroll(scrollableParent, x, y);\n        if (window.getComputedStyle(scrollableParent).position !== 'fixed') {\n            window.scrollBy({\n                left: parentRect.left,\n                top: parentRect.top,\n                behavior: 'smooth'\n            });\n        }\n    }\n    else {\n        window.scrollBy({\n            left: clientRect.left,\n            top: clientRect.top,\n            behavior: 'smooth'\n        });\n    }\n}\nfunction calculateScrollGoal(scrollableParent, parentRect, clientRect) {\n    const GAP = 16;\n    const clientLeft = clientRect.left + scrollableParent.scrollLeft - parentRect.left - GAP;\n    const clientRight = clientRect.right + scrollableParent.scrollLeft - parentRect.left + GAP;\n    const clientTop = clientRect.top + scrollableParent.scrollTop - parentRect.top - GAP;\n    const clientBottom = clientRect.bottom + scrollableParent.scrollTop - parentRect.top + GAP;\n    const parentWidth = scrollableParent.clientWidth;\n    const parentHeight = scrollableParent.clientHeight;\n    var x = scrollableParent.scrollLeft;\n    var y = scrollableParent.scrollTop;\n    if (clientRight - clientLeft - 2 * GAP > parentWidth)\n        x = clientLeft;\n    else if (clientRight > scrollableParent.scrollLeft + parentWidth)\n        x = clientRight - parentWidth;\n    else if (clientLeft < scrollableParent.scrollLeft)\n        x = clientLeft;\n    if (clientBottom - clientTop - 2 * GAP > parentHeight)\n        y = clientTop;\n    else if (clientBottom > scrollableParent.scrollTop + parentHeight)\n        y = clientBottom - parentHeight;\n    else if (clientTop < scrollableParent.scrollTop)\n        y = clientTop;\n    x = Math.max(0, x);\n    y = Math.max(0, y);\n    return { x, y };\n}\nconst concurrentScroll = new Map();\nfunction smoothScroll(scrollable, x, y) {\n    let activeGoal = concurrentScroll.get(scrollable);\n    if (activeGoal === undefined) {\n        activeGoal = { x: x, y: y };\n        concurrentScroll.set(scrollable, activeGoal);\n    }\n    else {\n        activeGoal.x = x;\n        activeGoal.y = y;\n    }\n    let startX, startY;\n    if (scrollable === document.body) {\n        startX = window.scrollX || window.pageXOffset;\n        startY = window.scrollY || window.pageYOffset;\n    }\n    else {\n        startX = scrollable.scrollLeft;\n        startY = scrollable.scrollTop;\n    }\n    const deltaX = x - startX;\n    const deltaY = y - startY;\n    if (deltaX === 0 && deltaY === 0) {\n        concurrentScroll.delete(scrollable);\n        return;\n    }\n    animate((value) => {\n        if (activeGoal.x !== x || activeGoal.y !== y) {\n            return false;\n        }\n        const nx = startX + value * deltaX;\n        const ny = startY + value * deltaY;\n        if (scrollable === document.body) {\n            window.scrollTo(nx, ny);\n        }\n        else {\n            scrollable.scrollLeft = nx;\n            scrollable.scrollTop = ny;\n        }\n        if (value === 1) {\n            concurrentScroll.delete(scrollable);\n        }\n        return true;\n    });\n}\nlet idSource = 0;\nexport function animate(callback) {\n    setTimeout(() => { window.requestAnimationFrame(animateStep.bind(window, callback, undefined, undefined)); }, 0);\n}\nfunction animateStep(callback, startTime, id) {\n    if (startTime === undefined) {\n        startTime = Date.now();\n        id = ++idSource;\n    }\n    const time = Date.now();\n    let elapsed = animationFrameCount > 0 ? (time - startTime) / animationFrameCount : 1;\n    elapsed = elapsed > 1 ? 1 : elapsed;\n    const value = ease(elapsed);\n    if (callback(value) === false)\n        return;\n    if (value < 1.0) {\n        window.requestAnimationFrame(animateStep.bind(window, callback, startTime, id));\n    }\n}\nfunction ease(k) {\n    return 0.5 * (1 - Math.cos(Math.PI * k));\n}\nvar ROUNDING_TOLERANCE = isMicrosoftBrowser(window.navigator.userAgent) ? 1 : 0;\nfunction isMicrosoftBrowser(userAgent) {\n    const userAgentPatterns = ['MSIE ', 'Trident/', 'Edge/'];\n    return new RegExp(userAgentPatterns.join('|')).test(userAgent);\n}\nexport function findScrollableParent(el) {\n    while (el !== document.body && isScrollable(el) === false) {\n        if (el.parentElement === null)\n            return undefined;\n        el = el.parentElement;\n    }\n    return el;\n}\nexport function isScrollable(el) {\n    const isScrollableY = hasScrollableSpace(el, \"Y\") && canOverflow(el, \"Y\");\n    const isScrollableX = hasScrollableSpace(el, \"X\") && canOverflow(el, \"X\");\n    return isScrollableY || isScrollableX;\n}\nfunction hasScrollableSpace(el, axis) {\n    if (axis === 'X')\n        return el.clientWidth + ROUNDING_TOLERANCE < el.scrollWidth;\n    else\n        return el.clientHeight + ROUNDING_TOLERANCE < el.scrollHeight;\n}\nfunction canOverflow(el, axis) {\n    const style = window.getComputedStyle(el, null);\n    const overflowValue = style['overflow' + axis];\n    return overflowValue === 'auto' || overflowValue === 'scroll';\n}\n//# sourceMappingURL=scrollIntoView.js.map","export var TableEditMode;\n(function (TableEditMode) {\n    TableEditMode[TableEditMode[\"EDIT_CELL\"] = 0] = \"EDIT_CELL\";\n    TableEditMode[TableEditMode[\"SELECT_CELL\"] = 1] = \"SELECT_CELL\";\n    TableEditMode[TableEditMode[\"SELECT_ROW\"] = 2] = \"SELECT_ROW\";\n})(TableEditMode || (TableEditMode = {}));\n//# sourceMappingURL=TableEditMode.js.map","export var TableEventType;\n(function (TableEventType) {\n    TableEventType[TableEventType[\"INSERT_ROW\"] = 0] = \"INSERT_ROW\";\n    TableEventType[TableEventType[\"REMOVE_ROW\"] = 1] = \"REMOVE_ROW\";\n    TableEventType[TableEventType[\"INSERT_COL\"] = 2] = \"INSERT_COL\";\n    TableEventType[TableEventType[\"REMOVE_COL\"] = 3] = \"REMOVE_COL\";\n    TableEventType[TableEventType[\"CELL_CHANGED\"] = 4] = \"CELL_CHANGED\";\n    TableEventType[TableEventType[\"RESIZE_ROW\"] = 5] = \"RESIZE_ROW\";\n    TableEventType[TableEventType[\"RESIZE_COL\"] = 6] = \"RESIZE_COL\";\n    TableEventType[TableEventType[\"CHANGED\"] = 7] = \"CHANGED\";\n})(TableEventType || (TableEventType = {}));\n//# sourceMappingURL=TableEventType.js.map","import { Model } from \"../model/Model.js\";\nexport class TableModel extends Model {\n    isEmpty() { return this.colCount === 0 && this.rowCount === 0; }\n}\n//# sourceMappingURL=TableModel.js.map","export class TablePos {\n    constructor(col, row) {\n        this.col = col;\n        this.row = row;\n    }\n}\n//# sourceMappingURL=TablePos.js.map","import { Model } from \"../model/Model.js\";\nimport { TableEditMode } from \"./TableEditMode.js\";\nimport { TablePos } from \"./TablePos.js\";\nexport class SelectionModel extends Model {\n    constructor(mode = TableEditMode.EDIT_CELL) {\n        super();\n        this.mode = mode;\n        this._value = new TablePos(0, 0);\n    }\n    set col(col) {\n        if (this._value.col === col)\n            return;\n        this._value.col = col;\n        this.modified.trigger();\n    }\n    get col() {\n        return this._value.col;\n    }\n    set row(row) {\n        if (this._value.row === row)\n            return;\n        this._value.row = row;\n        this.modified.trigger();\n    }\n    get row() {\n        return this._value.row;\n    }\n    set value(value) {\n        if (this._value.col === value.col && this._value.row === value.row)\n            return;\n        this._value = value;\n        this.modified.trigger();\n    }\n    get value() {\n        return this._value;\n    }\n}\n//# sourceMappingURL=SelectionModel.js.map","import { TableModel } from \"./TableModel.js\";\nexport class TypedTableModel extends TableModel {\n    constructor(nodeClass, root) {\n        super();\n        this.nodeClass = nodeClass;\n    }\n}\n//# sourceMappingURL=TypedTableModel.js.map","import { TypedTableModel } from \"./TypedTableModel.js\";\nexport class TableAdapter {\n    get colCount() {\n        return this.model === undefined ? 0 : this.model.colCount;\n    }\n    get rowCount() {\n        return this.model === undefined ? 0 : this.model.rowCount;\n    }\n    setModel(model) {\n        this.model = model;\n    }\n    getColumnHead(col) { return undefined; }\n    getRowHead(row) { return undefined; }\n    getDisplayCell(col, row) { return undefined; }\n    getEditorCell(col, row) { return undefined; }\n    isViewCompact() { return false; }\n    static register(adapter, model, data) {\n        let typeToModel = TableAdapter.modelToAdapter.get(model);\n        if (typeToModel === undefined) {\n            typeToModel = new Map();\n            TableAdapter.modelToAdapter.set(model, typeToModel);\n        }\n        if (typeToModel.get(data) !== undefined) {\n            throw Error(`attempt to redefine existing table adapter`);\n        }\n        typeToModel.set(data, adapter);\n    }\n    static unbind() {\n        TableAdapter.modelToAdapter.clear();\n    }\n    static lookup(model) {\n        let dataType;\n        if (model instanceof TypedTableModel) {\n            dataType = model.nodeClass;\n        }\n        else {\n            dataType = undefined;\n        }\n        let adapter = TableAdapter.modelToAdapter.get(Object.getPrototypeOf(model).constructor)?.get(dataType);\n        if (adapter === undefined) {\n            for (let baseClass of TableAdapter.modelToAdapter.keys()) {\n                if (model instanceof baseClass) {\n                    adapter = TableAdapter.modelToAdapter.get(baseClass)?.get(dataType);\n                    break;\n                }\n            }\n        }\n        if (adapter === undefined) {\n            let msg = `TableAdapter.lookup(): Did not find an adapter for model of type ${model.constructor.name}`;\n            msg += `\\n    Requested adapter: model=${model.constructor.name}, type=${dataType.name}\\n    Available adapters:`;\n            for (const [modelX, typeToAdapterX] of TableAdapter.modelToAdapter) {\n                for (const [typeX, adapterX] of typeToAdapterX) {\n                    msg += `\\n        model=${modelX.name}, type=${typeX}`;\n                }\n            }\n            throw Error(msg);\n        }\n        return adapter;\n    }\n}\nTableAdapter.modelToAdapter = new Map();\n//# sourceMappingURL=TableAdapter.js.map","export let tableStyle = document.createElement(\"style\");\ntableStyle.textContent = `\n:host {\n  position: relative;\n  display: inline-block;\n  border: 1px #ccc solid;\n  border-radius: 3px;\n  outline-offset: -2px;\n  font-family: var(--toad-font-family, sans-serif);\n  font-size: var(--toad-font-size, 12px);\n  background: #fff;\n}\n:host:focus .cells tr.selected,\n:host:focus .cells td.selected {\n  background: #0069d4;\n  color: #fff;\n}\n\n.colhead {\n  position: absolute;\n  top: 0;\n  overflow: hidden;\n}\n.rowhead {\n  position: absolute;\n  left: 0;\n  overflow: hidden;\n}\n.cells {\n  position: absolute;\n\n  bottom: 0;\n  right: 0;\n\n  overflow: auto;\n  /* resize: both; */\n  cursor: default;\n}\n\n:host > div > table, :host > table {\n  border-collapse: collapse;\n  border-spacing: 0;\n  border: none 0px;\n}\n.colhead > table, .rowhead > table {\n  background: #e0e0e0;\n}\n\n.colhead th,\n.rowhead th,\n.cells td,\n.hiddenSizeCheck td {\n  letter-spacing: 0;  \n  overflow: hidden;   \n  padding: 2px;\n  margin: 0px;\n\n  /* this might not be always desirable; */\n  white-space: nowrap; \n\n  border: solid 1px #ccc;\n}\n\n.colhead th, .rowhead th {\n  z-index: 1;\n}\n\n.bodyrow td {\n  padding-top: 0px;\n  padding-bottom: 0px;\n  border-top: none 0px;\n  border-bottom: none 0px;\n}\n\n.cells tr:nth-child(even) {\n  background: var(--toad-table-even-row, #f5f5f5);\n}\n.cells tr:nth-child(odd) {\n  background: var(--toad-table-odd-row, #ffffff);\n}\n\n.cells td:nth-child(1) {\n  border-left: none;\n}\n.cells tr:nth-child(2) td {\n  border-top: none;\n}\n\n.cells tr.selected,\n.cells tr td.selected {\n  background: #808080;\n  color: #fff;\n}\n\n.compact.colhead th,\n.compact.rowhead th,\n.compact.hiddenSizeCheck * th {\n  border-color: none;\n  border-style: none;\n  border-width: 0;\n  padding: 0px;\n}\n.compact.cells * td,\n.compact.hiddenSizeCheck * td {\n  border-color: none;\n  border-style: none;\n  border-width: 0;\n  padding: 0px;\n}\n\n.zeroSize {\n  width: 0;\n  height: 0;\n  margin: 0;\n  padding: 0;\n  border: none;\n}\n\n.inputDiv { \n  position: relative;\n  background: #fff;\n  border: none;\n  opacity: 0;\n}\n\n.hiddenSizeCheck {\n  position: absolute;\n  opacity: 0;\n}\n`;\n//# sourceMappingURL=tableStyle.js.map","import * as dom from \"../../util/dom.js\";\nimport { findScrollableParent } from \"../../util/scrollIntoView.js\";\nexport class InputOverlay extends HTMLDivElement {\n    static init(div) {\n        div.addEventListener(\"focusin\", (event) => {\n            div.style.opacity = \"1\";\n            if (event.target && event.relatedTarget) {\n                try {\n                    if (dom.isNodeBeforeNode(event.relatedTarget, div)) {\n                        if (div.focusInFromLeft)\n                            div.focusInFromLeft();\n                    }\n                    else {\n                        if (div.focusInFromRight)\n                            div.focusInFromRight();\n                    }\n                }\n                catch (e) { }\n            }\n        });\n        div.addEventListener(\"focusout\", (event) => {\n            div.style.opacity = \"0\";\n        });\n        div.style.display = \"none\";\n        div.setViewRect = InputOverlay.prototype.setViewRect;\n        div.unsetViewRect = InputOverlay.prototype.unsetViewRect;\n        div.setEditView = InputOverlay.prototype.setEditView;\n        div.adjustToCell = InputOverlay.prototype.adjustToCell;\n    }\n    setEditView(fieldView) {\n        const scrollableParent = findScrollableParent(this);\n        let savedScrollLeft = 0, savedScrollTop = 0;\n        if (scrollableParent !== undefined)\n            [savedScrollLeft, savedScrollTop] = [scrollableParent.scrollLeft, scrollableParent.scrollTop];\n        if (!this.hasChildNodes()) {\n            if (fieldView)\n                this.appendChild(fieldView);\n        }\n        else {\n            if (dom.hasFocus(this.children[0])) {\n                this.children[0].dispatchEvent(new FocusEvent(\"blur\"));\n            }\n            if (fieldView)\n                this.replaceChild(fieldView, this.childNodes[0]);\n            else\n                this.removeChild(this.childNodes[0]);\n        }\n        this.style.display = fieldView ? \"\" : \"none\";\n        if (scrollableParent !== undefined) {\n            scrollableParent.scrollLeft = savedScrollLeft;\n            scrollableParent.scrollTop = savedScrollTop;\n        }\n    }\n    adjustToCell(cell) {\n        if (!this.hasChildNodes()) {\n            this.unsetViewRect();\n            return;\n        }\n        if (cell === undefined)\n            return;\n        let boundary = cell.getBoundingClientRect();\n        let tr = cell.parentElement;\n        if (tr === null) {\n            return;\n        }\n        let tbody = tr.parentElement;\n        if (tbody === null) {\n            return;\n        }\n        let top, left;\n        if (navigator.userAgent.indexOf(\"Chrome\") > -1) {\n            left = cell.offsetLeft + 2;\n            top = cell.offsetTop - tbody.clientHeight;\n        }\n        else {\n            left = cell.offsetLeft + 0.5;\n            top = cell.offsetTop - tbody.clientHeight;\n        }\n        const width = cell.clientWidth - dom.horizontalPadding(cell);\n        const height = boundary.height;\n        this.setViewRect(top, left, width, height);\n    }\n    setViewRect(top, left, width, height) {\n        this.style.display = \"\";\n        this.style.opacity = \"1\";\n        this.style.top = `${top}px`;\n        this.style.left = `${left}px`;\n        this.style.width = `${width}px`;\n        this.style.height = `${height}px`;\n    }\n    unsetViewRect() {\n        this.style.opacity = \"0\";\n        this.style.display = \"none\";\n        this.style.top = \"\";\n        this.style.left = \"\";\n        this.style.width = \"\";\n        this.style.height = \"\";\n    }\n}\n//# sourceMappingURL=InputOverlay.js.map","import { jsx as _jsx } from \"toad.jsx/lib/jsx-runtime\";\nimport { AnimationBase } from \"../../util/animation.js\";\nvar SelectionIs;\n(function (SelectionIs) {\n    SelectionIs[SelectionIs[\"BEFORE_REMOVED_AREA\"] = 0] = \"BEFORE_REMOVED_AREA\";\n    SelectionIs[SelectionIs[\"INSIDE_REMOVED_AREA\"] = 1] = \"INSIDE_REMOVED_AREA\";\n    SelectionIs[SelectionIs[\"INSIDE_REMOVED_AREA_AND_NO_FURTHER_ROWS\"] = 2] = \"INSIDE_REMOVED_AREA_AND_NO_FURTHER_ROWS\";\n    SelectionIs[SelectionIs[\"BEHIND_REMOVED_AREA\"] = 3] = \"BEHIND_REMOVED_AREA\";\n})(SelectionIs || (SelectionIs = {}));\nexport class RemoveRowAnimation extends AnimationBase {\n    constructor(table, event) {\n        super();\n        this.rowAnimationHeight = 0;\n        this.hadFocus = false;\n        this.table = table;\n        this.event = event;\n    }\n    prepare() {\n        this.hadFocus = this.table.hasFocus();\n        let overlayTopDrift = 0;\n        if (this.table.editView && this.table.selectionModel !== undefined) {\n            if (this.table.selectionModel.row < this.event.index) {\n                this.selectionIs = SelectionIs.BEFORE_REMOVED_AREA;\n            }\n            else if (this.table.selectionModel.row <= this.event.index + this.event.size) {\n                const rowCount = this.table.bodyBody.children.length - 1;\n                if (this.event.index + this.event.size >= rowCount) {\n                    this.selectionIs = SelectionIs.INSIDE_REMOVED_AREA_AND_NO_FURTHER_ROWS;\n                    for (let i = this.event.index; i <= this.table.selectionModel.row; ++i) {\n                        const tr = this.table.bodyBody.children[i + 1];\n                        overlayTopDrift -= tr.clientHeight;\n                    }\n                    if (this.event.index === 0) {\n                        this.table.selectionModel.row = 0;\n                    }\n                    else {\n                        this.table.selectionModel.row = this.event.index - 1;\n                    }\n                }\n                else {\n                    this.selectionIs = SelectionIs.INSIDE_REMOVED_AREA;\n                    for (let i = this.event.index + 1; i <= this.table.selectionModel.row; ++i) {\n                        const tr = this.table.bodyBody.children[i + 1];\n                        overlayTopDrift -= tr.clientHeight;\n                    }\n                    this.table.selectionModel.row = this.event.index;\n                    this.table.prepareInputOverlayForPosition({ col: this.table.selectionModel.value.col, row: this.table.selectionModel.value.row });\n                }\n            }\n            else {\n                this.table.selectionModel.row -= this.event.size;\n                this.selectionIs = SelectionIs.BEHIND_REMOVED_AREA;\n            }\n        }\n        this.rowAnimationHeight = 0;\n        for (let i = 0; i < this.event.size; ++i) {\n            const tr = this.table.bodyBody.children[this.event.index + i + 1];\n            this.rowAnimationHeight += tr.clientHeight;\n        }\n        this.table.rowAnimationHeight = this.rowAnimationHeight;\n        for (let i = 1; i < this.event.size; ++i) {\n            this.table.rowHeadHead.deleteRow(this.event.index + 1);\n            this.table.bodyBody.deleteRow(this.event.index + 2);\n        }\n        this.trAnimationHead = this.table.rowHeadHead.children[this.event.index];\n        this.trAnimationBody = this.table.bodyBody.children[this.event.index + 1];\n        this.trAnimationHead.style.minHeight = this.trAnimationHead.style.maxHeight = \"\";\n        this.trAnimationBody.style.minHeight = this.trAnimationBody.style.maxHeight = \"\";\n        this.trAnimationHead.style.height = `${this.rowAnimationHeight}px`;\n        this.trAnimationBody.style.height = `${this.rowAnimationHeight}px`;\n        const img = `url(\\\"data:image/svg+xml;utf8,<svg width='3' height='3' xmlns='http://www.w3.org/2000/svg'><line shape-rendering='crispEdges' x1='-1' y1='-1' x2='5' y2='5' stroke='%23888' /></svg>\\\")`;\n        while (this.trAnimationHead.childNodes.length > 0)\n            this.trAnimationHead.removeChild(this.trAnimationHead.childNodes[0]);\n        while (this.trAnimationBody.childNodes.length > 0)\n            this.trAnimationBody.removeChild(this.trAnimationBody.childNodes[0]);\n        this.trAnimationHead.appendChild(_jsx(\"th\", { style: { padding: \"0\" } }, void 0));\n        this.trAnimationHead.style.background = img;\n        for (let i = 0; i < this.table.adapter.colCount; ++i) {\n            this.trAnimationBody.appendChild(_jsx(\"td\", { style: { padding: \"0\" } }, void 0));\n            this.trAnimationBody.style.background = img;\n        }\n        const top = this.table.inputOverlay.style.top;\n        if (top.length > 2)\n            this.overlayTop = Number.parseFloat(top.substr(0, top.length - 2)) + overlayTopDrift;\n    }\n    animationFrame(value) {\n        const inverseValue = 1 - value;\n        this.trAnimationBody.style.height = this.trAnimationHead.style.height = `${inverseValue * this.rowAnimationHeight}px`;\n        if (this.overlayTop) {\n            switch (this.selectionIs) {\n                case SelectionIs.BEFORE_REMOVED_AREA:\n                    this.table.inputOverlay.style.top = `${this.overlayTop + value * this.rowAnimationHeight}px`;\n                    break;\n                case SelectionIs.INSIDE_REMOVED_AREA:\n                    this.table.inputOverlay.style.top = `${this.overlayTop + this.rowAnimationHeight}px`;\n                    break;\n                case SelectionIs.INSIDE_REMOVED_AREA_AND_NO_FURTHER_ROWS:\n                    this.table.inputOverlay.style.top = `${this.overlayTop + value * this.rowAnimationHeight}px`;\n                    break;\n                case SelectionIs.BEHIND_REMOVED_AREA:\n                    this.table.inputOverlay.style.top = `${this.overlayTop}px`;\n                    break;\n            }\n        }\n    }\n    lastFrame() {\n        this.table.rowHeadHead.deleteRow(this.event.index);\n        this.table.bodyBody.deleteRow(this.event.index + 1);\n    }\n}\n//# sourceMappingURL=RemoveRowAnimation.js.map","import { jsx as _jsx, jsxs as _jsxs, Fragment as _Fragment } from \"toad.jsx/lib/jsx-runtime\";\nimport { ref } from 'toad.jsx';\nimport * as dom from \"../util/dom.js\";\nimport { scrollIntoView } from \"../util/scrollIntoView.js\";\nimport { View } from \"../view/View.js\";\nimport { TableModel } from \"./TableModel.js\";\nimport { SelectionModel } from \"./SelectionModel.js\";\nimport { TableEditMode } from \"./TableEditMode.js\";\nimport { TablePos } from \"./TablePos.js\";\nimport { TableAdapter } from \"./TableAdapter.js\";\nimport { TableEventType } from \"./TableEventType.js\";\nimport { tableStyle } from \"./private/tableStyle.js\";\nimport { InputOverlay } from \"./private/InputOverlay.js\";\nimport { Animator } from \"../util/animation.js\";\nimport { RemoveRowAnimation } from \"./private/RemoveRowAnimation.js\";\nimport { InsertRowAnimation } from \"./private/InsertRowAnimation.js\";\nvar Log;\n(function (Log) {\n    Log[Log[\"LAYOUT\"] = 0] = \"LAYOUT\";\n    Log[Log[\"SELECTION\"] = 1] = \"SELECTION\";\n    Log[Log[\"USER\"] = 2] = \"USER\";\n})(Log || (Log = {}));\nexport class TableView extends View {\n    constructor() {\n        super();\n        this.animator = new Animator();\n        this.rowAnimationHeight = 0;\n        this.insideGoTo = false;\n        this.rootDiv =\n            _jsxs(_Fragment, { children: [_jsx(\"div\", { set: ref(this, 'rowHeadDiv'), class: \"rowhead\", children: _jsx(\"table\", { set: ref(this, 'rowHeadTable'), children: _jsx(\"thead\", { set: ref(this, 'rowHeadHead') }, void 0) }, void 0) }, void 0), _jsx(\"div\", { set: ref(this, 'colHeadDiv'), class: \"colhead\", children: _jsx(\"table\", { set: ref(this, 'colHeadTable'), children: _jsx(\"thead\", { children: _jsx(\"tr\", { set: ref(this, 'colHeadRow') }, void 0) }, void 0) }, void 0) }, void 0), _jsxs(\"div\", { set: ref(this, 'scrollDiv'), class: \"cells\", children: [_jsx(\"table\", { set: ref(this, 'bodyTable'), children: _jsx(\"tbody\", { set: ref(this, 'bodyBody'), children: _jsx(\"tr\", { set: ref(this, 'bodyRow'), class: \"bodyrow\" }, void 0) }, void 0) }, void 0), _jsx(\"div\", { class: \"zeroSize\", children: _jsx(\"div\", { set: ref(this, 'inputOverlay'), class: \"inputDiv\" }, void 0) }, void 0)] }, void 0), _jsxs(\"table\", { class: \"hiddenSizeCheck\", children: [_jsx(\"thead\", { set: ref(this, 'hiddenSizeCheckRowHead') }, void 0), _jsx(\"tbody\", { set: ref(this, 'hiddenSizeCheckBody') }, void 0)] }, void 0)] }, void 0);\n        this.onkeydown = this.onRootDivKeyDown;\n        this.scrollDiv.onscroll = () => {\n            this.rowHeadDiv.scrollTop = this.scrollDiv.scrollTop;\n            this.colHeadDiv.scrollLeft = this.scrollDiv.scrollLeft;\n        };\n        this.bodyTable.onmousedown = (event) => {\n            if (!event.target) {\n                console.log(\"bodyTable.onmousedown() -> no target\");\n                return;\n            }\n            if (event.target.tagName !== \"TD\") {\n                console.log(`bodyTable.onmousedown() -> target is not TD but ${event.target.tagName}`);\n                return;\n            }\n            event.preventDefault();\n            this.log(Log.USER, `bodyTable.onmousedown() -> goToCell(event.target)`);\n            this.goToCell(event.target);\n        };\n        InputOverlay.init(this.inputOverlay);\n        this.inputOverlay.focusInFromLeft = () => {\n            if (!this.insideGoTo)\n                this.goToFirstCell();\n        };\n        this.inputOverlay.focusInFromRight = () => {\n            if (!this.insideGoTo)\n                this.goToLastCell();\n        };\n        this.attachShadow({ mode: 'open' });\n        this.shadowRoot.appendChild(document.importNode(tableStyle, true));\n        this.rootDiv.appendTo(this.shadowRoot);\n    }\n    log(what, msg) {\n    }\n    updateModel() {\n    }\n    setModel(model) {\n        if (!model) {\n            if (this.selectionModel)\n                this.selectionModel.modified.remove(this);\n            this.model = undefined;\n            this.selectionModel = new SelectionModel();\n            this.selectionModel.modified.add(() => {\n                this.createSelection();\n            }, this);\n            this.updateView();\n            return;\n        }\n        if (model instanceof SelectionModel) {\n            if (this.selectionModel) {\n                this.selectionModel.modified.remove(this);\n            }\n            this.selectionModel = model;\n            this.createSelection();\n            this.selectionModel.modified.add(() => {\n                this.createSelection();\n            }, this);\n            return;\n        }\n        if (model instanceof TableModel) {\n            this.model = model;\n            this.model.modified.add((event) => { this.modelChanged(event); }, this);\n            const adapter = TableAdapter.lookup(model);\n            try {\n                this.adapter = new adapter();\n            }\n            catch (e) {\n                console.log(`TableView.setModel(): failed to instantiate table adapter: ${e}`);\n                console.log(`setting TypeScript's target to 'es6' might help`);\n                throw e;\n            }\n            this.adapter.setModel(model);\n            this.updateCompact();\n            this.updateView();\n            return;\n        }\n        throw Error(\"TableView.setModel(): unexpected model of type \" + model.constructor.name);\n    }\n    updateCompact() {\n        if (this.adapter?.isViewCompact()) {\n            this.rootDiv.forEach(child => child.classList.add(\"compact\"));\n        }\n        else {\n            this.rootDiv.forEach(child => child.classList.remove(\"compact\"));\n        }\n    }\n    modelChanged(event) {\n        switch (event.type) {\n            case TableEventType.INSERT_ROW:\n                this.animator.run(new InsertRowAnimation(this, event));\n                break;\n            case TableEventType.REMOVE_ROW:\n                this.animator.run(new RemoveRowAnimation(this, event));\n                break;\n            case TableEventType.CELL_CHANGED:\n                this.onFieldViewBlur(new TablePos(event.col, event.row));\n                break;\n        }\n    }\n    updateView() {\n        try {\n            if (!this.model) {\n                return;\n            }\n            this.createColumnHeader();\n            this.createRowHeader();\n            this.createBody();\n            this.createSelection();\n            setTimeout(() => {\n                if (this.model)\n                    this.adjustLayoutAfterRender();\n            }, 0);\n        }\n        catch (e) {\n            console.log(\"caught exception in updateView\");\n            if (e instanceof Error) {\n                console.log(e.stack);\n            }\n            throw e;\n        }\n    }\n    createColumnHeader() {\n        this.updateHeader(true);\n    }\n    createRowHeader() {\n        this.updateHeader(false);\n    }\n    updateHeader(column) {\n        if (!this.model)\n            throw Error(\"TableView.updateHeader(): no model\");\n        if (!this.adapter)\n            throw Error(\"TableView.updateHeader(): no adapter\");\n        let headTable, headRow, count;\n        if (column === true) {\n            headTable = this.colHeadTable;\n            headRow = this.colHeadRow;\n            count = this.adapter.colCount;\n        }\n        else {\n            headTable = this.rowHeadTable;\n            headRow = this.rowHeadHead;\n            count = this.adapter.rowCount;\n        }\n        let noHeader = false;\n        while (headRow.children.length > count + 1)\n            headRow.removeChild(headRow.children[headRow.children.length - 1]);\n        for (let i = 0; i < count; ++i) {\n            let cell;\n            if (i >= headRow.children.length) {\n                cell = _jsx(\"th\", {}, void 0);\n                if (column) {\n                    headRow.appendChild(cell);\n                }\n                else {\n                    const row = _jsx(\"tr\", {}, void 0);\n                    row.appendChild(cell);\n                    headRow.appendChild(row);\n                }\n            }\n            else {\n                if (column)\n                    cell = headRow.children[i];\n                else\n                    cell = headRow.children[i].children[0];\n                cell.style.minWidth = \"\";\n                cell.style.border = \"\";\n            }\n            const content = column ? this.adapter.getColumnHead(i) : this.adapter.getRowHead(i);\n            if (content === undefined) {\n                noHeader = true;\n                continue;\n            }\n            cell.appendChild(content);\n        }\n        let fillerForMissingScrollbar;\n        if (headRow.children.length < count + 1) {\n            fillerForMissingScrollbar = _jsx(\"th\", {}, void 0);\n            if (column) {\n                headRow.appendChild(fillerForMissingScrollbar);\n            }\n            else {\n                const row = _jsx(\"tr\", {}, void 0);\n                row.appendChild(fillerForMissingScrollbar);\n                headRow.appendChild(row);\n            }\n        }\n        else {\n            if (column)\n                fillerForMissingScrollbar = headRow.children[headRow.children.length - 1];\n            else\n                fillerForMissingScrollbar = headRow.children[headRow.children.length - 1].children[0];\n        }\n        if (column) {\n            fillerForMissingScrollbar.innerText = \"\";\n            fillerForMissingScrollbar.style.minWidth = \"777px\";\n        }\n        else {\n            fillerForMissingScrollbar.parentElement.style.height = \"777px\";\n        }\n        fillerForMissingScrollbar.style.border = \"0px none\";\n        headTable.style.display = noHeader ? \"none\" : \"\";\n    }\n    createBody() {\n        if (!this.model)\n            throw Error(\"TableView.updateBody(): no model\");\n        if (!this.adapter)\n            throw Error(\"TableView.updateBody(): no adapter\");\n        while (this.bodyRow.children.length > this.adapter.colCount)\n            this.bodyRow.removeChild(this.bodyRow.children[this.bodyRow.children.length - 1]);\n        while (this.bodyRow.children.length < this.adapter.colCount) {\n            this.bodyRow.appendChild(_jsx(\"td\", {}, void 0));\n        }\n        while (this.bodyBody.children.length - 1 > this.adapter.rowCount)\n            this.bodyBody.removeChild(this.bodyBody.children[this.bodyBody.children.length - 1]);\n        for (let row = 0; row < this.adapter.rowCount; ++row) {\n            let bodyRow;\n            if (row + 1 >= this.bodyBody.children.length) {\n                bodyRow = _jsx(\"tr\", {}, void 0);\n                this.bodyBody.appendChild(bodyRow);\n            }\n            else {\n                bodyRow = this.bodyBody.children[row + 1];\n            }\n            while (bodyRow.children.length > this.adapter.colCount)\n                bodyRow.removeChild(bodyRow.children[bodyRow.children.length - 1]);\n            for (let col = 0; col < this.adapter.colCount; ++col) {\n                let cell;\n                if (col >= bodyRow.children.length) {\n                    cell = _jsx(\"td\", {}, void 0);\n                    bodyRow.appendChild(cell);\n                }\n                else {\n                    cell = bodyRow.children[col];\n                }\n                cell.style.width = \"\";\n                const content = this.adapter.getDisplayCell(col, row);\n                if (content) {\n                    if (Array.isArray(content))\n                        content.forEach(e => cell.appendChild(e));\n                    else\n                        cell.appendChild(content);\n                }\n            }\n            if (this.style.width === \"100%\") {\n                let lastCell = bodyRow.children[bodyRow.children.length - 1];\n                lastCell.style.width = \"100%\";\n            }\n        }\n    }\n    createDOMRowHeaderRow(row) {\n        if (!this.model || !this.adapter)\n            throw Error();\n        const cell = this.adapter.getRowHead(row);\n        if (cell === undefined)\n            return _jsx(\"tr\", {}, void 0);\n        return _jsx(\"tr\", { children: _jsx(\"th\", { children: cell }, void 0) }, void 0);\n    }\n    createDOMBodyRow(row) {\n        if (!this.model || !this.adapter)\n            throw Error();\n        const result = _jsx(\"tr\", {}, void 0);\n        for (let col = 0; col < this.adapter.colCount; ++col) {\n            let cell;\n            if (col >= result.children.length) {\n                cell = _jsx(\"td\", {}, void 0);\n                result.appendChild(cell);\n            }\n            else {\n                cell = result.children[col];\n            }\n            cell.style.width = \"\";\n            const content = this.adapter.getDisplayCell(col, row);\n            if (content) {\n                if (Array.isArray(content))\n                    content.forEach(e => cell.appendChild(e));\n                else\n                    cell.appendChild(content);\n            }\n        }\n        if (this.style.width === \"100%\") {\n            let lastCell = result.children[result.children.length - 1];\n            lastCell.style.width = \"100%\";\n        }\n        return result;\n    }\n    createSelection() {\n        if (this.selectionModel === undefined)\n            return;\n        switch (this.selectionModel.mode) {\n            case TableEditMode.EDIT_CELL:\n                this.log(Log.SELECTION, `TableView.createSelection(): mode=EDIT_CELL, selection=${this.selectionModel.col}, ${this.selectionModel.row}`);\n                this.prepareInputOverlayForPosition(new TablePos(this.selectionModel.col, this.selectionModel.row));\n                delete this.rootDiv.tabIndex;\n                break;\n            case TableEditMode.SELECT_CELL: {\n                this.log(Log.SELECTION, `TableView.createSelection(): mode=SELECT_CELL, selection=${this.selectionModel.col}, ${this.selectionModel.row}`);\n                let allSelected = this.bodyBody.querySelectorAll(\"tbody > tr > td.selected\");\n                for (let selected of allSelected)\n                    selected.classList.remove(\"selected\");\n                this.toggleCellSelection(this.selectionModel.value, true);\n                this.tabIndex = 0;\n                break;\n            }\n            case TableEditMode.SELECT_ROW: {\n                this.log(Log.SELECTION, `TableView.createSelection(): mode=SELECT_ROW, selection=${this.selectionModel.col}, ${this.selectionModel.row}`);\n                let allSelected = this.bodyBody.querySelectorAll(\"tbody > tr.selected\");\n                for (let selected of allSelected)\n                    selected.classList.remove(\"selected\");\n                this.toggleRowSelection(this.selectionModel.value.row, true);\n                this.tabIndex = 0;\n                break;\n            }\n        }\n    }\n    adjustLayout(pos) {\n        this.unadjustLayoutBeforeRender(pos);\n        setTimeout(() => {\n            this.adjustLayoutAfterRender();\n        }, 0);\n    }\n    unadjustLayoutBeforeRender(pos) {\n        if (pos === undefined) {\n            for (let column = 0; column < this.adapter.colCount; ++column) {\n                this.unadjustLayoutColumnBeforeRender(column);\n            }\n        }\n        else {\n            this.unadjustLayoutColumnBeforeRender(pos.col);\n        }\n    }\n    unadjustLayoutColumnBeforeRender(column) {\n        const head = this.colHeadRow.children[column];\n        const body = this.bodyRow.children[column];\n        head.style.width = head.style.minWidth = head.style.maxWidth =\n            body.style.width = body.style.minWidth = body.style.maxWidth = \"\";\n    }\n    adjustLayoutAfterRender() {\n        if (!this.model)\n            throw Error(\"TableView.adjustLayoutAfterRender(): no model\");\n        if (!this.adapter)\n            throw Error(\"TableView.adjustLayoutAfterRender(): no adapter\");\n        this.log(Log.LAYOUT, `TableView.adjustLayoutAfterRender()`);\n        const colHeadRow = this.colHeadRow.children;\n        const rowHeadHead = this.rowHeadHead.children;\n        const bodyRow = this.bodyRow.children;\n        for (let col = 0; col < this.adapter.colCount; ++col) {\n            const columnHeader = colHeadRow[col];\n            const columnBody = bodyRow[col];\n            if (columnHeader.style.width === \"\") {\n                const headWidth = columnHeader.getBoundingClientRect().width - dom.horizontalPadding(columnHeader);\n                const bodyWidth = columnBody.getBoundingClientRect().width - dom.horizontalPadding(columnBody);\n                const width = Math.max(headWidth, bodyWidth);\n                columnHeader.style.width = columnHeader.style.minWidth = columnHeader.style.maxWidth = `${width}px`;\n                columnBody.style.width = columnBody.style.minWidth = columnBody.style.maxWidth = `${width}px`;\n            }\n        }\n        if (this.adapter.rowCount != this.bodyBody.children.length - 1) {\n            this.log(Log.LAYOUT, `adjustLayoutAfterRender(): bodyBody has ${this.bodyBody.children.length - 1} rows while model has ${this.adapter.rowCount} rows`);\n        }\n        for (let row = 0; row < this.bodyBody.children.length - 1; ++row) {\n            const rowHeader = rowHeadHead[row];\n            const rowBody = this.bodyBody.children[row + 1];\n            let headHeight = rowHeader.clientHeight - dom.verticalPadding(rowHeader);\n            let bodyHeight = rowBody.clientHeight - dom.verticalPadding(rowBody);\n            let height = Math.max(headHeight, bodyHeight);\n            rowHeader.style.height = rowHeader.style.minHeight = rowHeader.style.maxHeight =\n                rowBody.style.height = rowBody.style.minHeight = rowBody.style.maxHeight =\n                    `${height}px`;\n        }\n        function b2s(r) {\n            return `${r.x}, ${r.y}, ${r.width}, ${r.height}`;\n        }\n        const columnHeadBounds = this.colHeadDiv.getBoundingClientRect();\n        const rowHeadBounds = this.rowHeadDiv.getBoundingClientRect();\n        let scrollBounds = this.scrollDiv.getBoundingClientRect();\n        let cellsBounds = this.bodyTable.getBoundingClientRect();\n        const computedStyle = window.getComputedStyle(this);\n        const computedWidth = computedStyle.width;\n        const computedHeight = computedStyle.height;\n        this.style.overflowX = \"\";\n        this.style.overflowY = \"\";\n        let enoughHorizontalSpace = false;\n        let enoughVerticalSpace = false;\n        if (computedWidth === \"0px\") {\n            this.log(Log.LAYOUT, `  TableView has no width specified`);\n            const parent = this.parentElement;\n            if (parent) {\n                const requiredWidth = rowHeadBounds.width + cellsBounds.width;\n                if (requiredWidth < parent.clientWidth) {\n                    this.log(Log.LAYOUT, `    parent is wide enough for content, set TableView width to ${requiredWidth}px`);\n                    this.style.width = requiredWidth + \"px\";\n                    this.scrollDiv.style.overflowX = \"hidden\";\n                    enoughHorizontalSpace = true;\n                }\n                else {\n                    this.log(Log.LAYOUT, `    parent isn't wide enough for content, set TableView width to parent's width of ${parent.clientWidth - 2}px`);\n                    this.style.width = (parent.clientWidth - 2) + \"px\";\n                }\n            }\n        }\n        if (computedHeight === \"0px\") {\n            this.log(Log.LAYOUT, `  TableView has no height specified`);\n            const parent = this.parentElement;\n            if (parent) {\n                let requiredHeight = columnHeadBounds.height + cellsBounds.height;\n                if (!enoughHorizontalSpace)\n                    requiredHeight += 15;\n                const maxHeight = window.innerHeight;\n                if (requiredHeight < maxHeight) {\n                    this.log(Log.LAYOUT, `    parent IS high enough for content, set TableView height to ${requiredHeight}px`);\n                    this.style.height = requiredHeight + \"px\";\n                    this.scrollDiv.style.overflowY = \"hidden\";\n                    enoughVerticalSpace = true;\n                }\n                else {\n                    this.log(Log.LAYOUT, `    parent is NOT high enough for content, default TableView height to ${maxHeight}px`);\n                    this.style.height = maxHeight + \"px\";\n                }\n            }\n        }\n        let outerBounds = this.getBoundingClientRect();\n        const hostBounds = {\n            x: this.clientLeft + outerBounds.x,\n            y: this.clientTop + outerBounds.y,\n            width: this.clientWidth,\n            height: this.clientHeight\n        };\n        this.log(Log.LAYOUT, `  adjust the bodyDiv to setup the scrollbars`);\n        if (enoughHorizontalSpace) {\n            this.log(Log.LAYOUT, `    table IS wide enough for content, do not set scrollDiv's width`);\n            this.scrollDiv.style.width = \"\";\n        }\n        else {\n            this.log(Log.LAYOUT, `    table is NOT wide enough for content, set scroll width to ${hostBounds.width - rowHeadBounds.width}px`);\n            this.scrollDiv.style.width = (hostBounds.width - rowHeadBounds.width) + \"px\";\n        }\n        if (enoughVerticalSpace) {\n            this.log(Log.LAYOUT, `    table IS heigh enough for content, do not set scrollDiv's height`);\n            this.scrollDiv.style.height = \"\";\n        }\n        else {\n            this.log(Log.LAYOUT, `    table is NOT high enough for content, set scroll height to ${hostBounds.height - columnHeadBounds.height}px`);\n            this.scrollDiv.style.height = (hostBounds.height - columnHeadBounds.height) + \"px\";\n        }\n        this.log(Log.LAYOUT, `  figure out how much space the scrollbars take`);\n        scrollBounds = this.scrollDiv.getBoundingClientRect();\n        let verticalScrollbarWidth = enoughVerticalSpace ? 0 : scrollBounds.width - this.scrollDiv.clientWidth;\n        let horizontalScrollbarHeight = enoughHorizontalSpace ? 0 : scrollBounds.height - this.scrollDiv.clientHeight;\n        this.log(Log.LAYOUT, `    width ${verticalScrollbarWidth}, height ${horizontalScrollbarHeight}`);\n        this.scrollDiv.style.top = columnHeadBounds.height + \"px\";\n        this.scrollDiv.style.left = rowHeadBounds.width + \"px\";\n        this.colHeadDiv.style.top = \"0\";\n        this.colHeadDiv.style.left = (rowHeadBounds.width - 1) + \"px\";\n        this.log(Log.LAYOUT, `  set colHeadDiv = ${hostBounds.width} (host width) - ${rowHeadBounds.width} (rowHeadDiv width) - ${verticalScrollbarWidth} (vertical scrollbar width) = ${hostBounds.width - rowHeadBounds.width - verticalScrollbarWidth + 1}`);\n        this.colHeadDiv.style.width = (hostBounds.width - rowHeadBounds.width - verticalScrollbarWidth + 1) + \"px\";\n        this.rowHeadDiv.style.top = columnHeadBounds.height + \"px\";\n        this.rowHeadDiv.style.left = \"0\";\n        this.rowHeadDiv.style.height = (hostBounds.height - columnHeadBounds.height - horizontalScrollbarHeight) + \"px\";\n    }\n    prepareInputOverlayForCell(cell) {\n        if (cell === undefined || cell.tagName !== \"TD\")\n            return;\n        this.prepareInputOverlayForPosition(this.getCellPosition(cell));\n    }\n    prepareInputOverlayForPosition(pos) {\n        if (!this.adapter)\n            return;\n        let hadFocus = this.hasFocus();\n        this.log(Log.USER, `TableView.prepareInputOverlayForPosition(${pos.col}, ${pos.row})`);\n        this.setSelectionTo(pos);\n        let editView = this.adapter.getEditorCell(pos.col, pos.row);\n        this.log(Log.SELECTION, `prepareInputOverlayForPosition() got editView=${editView}`);\n        if (!editView) {\n            this.inputOverlay.setEditView(undefined);\n            return;\n        }\n        this.editView = editView;\n        editView.classList.add(\"embedded\");\n        editView.onkeydown = (event) => {\n            this.onFieldViewKeyDown(event, pos);\n        };\n        this.inputOverlay.setEditView(editView);\n        const cell = this.getCellAt(pos.col, pos.row);\n        setTimeout(() => {\n            this.inputOverlay.adjustToCell(cell);\n            if (hadFocus)\n                this.focus();\n        }, 0);\n    }\n    setSelectionTo(pos) {\n        if (!this.selectionModel)\n            return;\n        switch (this.selectionModel.mode) {\n            case TableEditMode.EDIT_CELL:\n                this.selectionModel.value = pos;\n                break;\n            case TableEditMode.SELECT_CELL:\n                this.toggleCellSelection(this.selectionModel.value, false);\n                this.selectionModel.value = pos;\n                this.toggleCellSelection(this.selectionModel.value, true);\n                return;\n            case TableEditMode.SELECT_ROW:\n                this.toggleRowSelection(this.selectionModel.value.row, false);\n                this.selectionModel.value.row = pos.row;\n                this.toggleRowSelection(this.selectionModel.value.row, true);\n                return;\n        }\n    }\n    focus() {\n        const { x, y } = { x: this.scrollDiv.scrollLeft, y: this.scrollDiv.scrollTop };\n        if (this.editView) {\n            this.editView.focus({ preventScroll: true });\n        }\n        else {\n            super.focus({ preventScroll: true });\n        }\n        this.scrollDiv.scrollLeft = x;\n        this.scrollDiv.scrollTop = y;\n    }\n    hasFocus() {\n        return document.activeElement !== null && document.activeElement === this;\n    }\n    toggleCellSelection(pos, flag) {\n        if (pos.col >= this.adapter.colCount || pos.row >= this.adapter.rowCount)\n            return;\n        let element = this.bodyBody.children[pos.row + 1].children[pos.col];\n        element.classList.toggle(\"selected\", flag);\n        if (flag) {\n            scrollIntoView(element);\n        }\n    }\n    toggleRowSelection(row, flag) {\n        if (row >= this.adapter.rowCount)\n            return;\n        let rowElement = this.bodyBody.children[1 + this.selectionModel.value.row];\n        rowElement.classList.toggle(\"selected\", flag);\n        if (flag) {\n            scrollIntoView(rowElement);\n        }\n    }\n    goTo(column, row) {\n        this.insideGoTo = true;\n        this.prepareInputOverlayForPosition(new TablePos(column, row));\n        this.focus();\n        scrollIntoView(this.getCellAt(column, row));\n        this.insideGoTo = false;\n    }\n    goToCell(element) {\n        if (!element)\n            return;\n        this.insideGoTo = true;\n        this.prepareInputOverlayForCell(element);\n        this.focus();\n        scrollIntoView(element);\n        this.insideGoTo = false;\n    }\n    goToFirstCell() {\n        this.goTo(0, 0);\n    }\n    goToLastCell() {\n        if (this.adapter)\n            this.goTo(this.adapter.colCount - 1, this.adapter.rowCount - 1);\n    }\n    getCellAt(column, row) {\n        return this.bodyBody.children[row + 1].children[column];\n    }\n    getCellPosition(element) {\n        let col, row;\n        for (col = 0; col < this.adapter.colCount; ++col) {\n            if (element.parentElement.children[col] === element)\n                break;\n        }\n        for (row = 1; row < this.adapter.rowCount + 1; ++row) {\n            if (element.parentElement.parentElement.children[row] === element.parentElement)\n                break;\n        }\n        --row;\n        return new TablePos(col, row);\n    }\n    onRootDivKeyDown(event) {\n        if (!this.selectionModel)\n            return;\n        switch (this.selectionModel.mode) {\n            case TableEditMode.SELECT_ROW:\n                {\n                    let row = this.selectionModel.value.row;\n                    switch (event.key) {\n                        case \"ArrowDown\":\n                            if (row + 1 < this.adapter.rowCount)\n                                ++row;\n                            break;\n                        case \"ArrowUp\":\n                            if (row > 0)\n                                --row;\n                            break;\n                    }\n                    if (row != this.selectionModel.value.row) {\n                        this.toggleRowSelection(this.selectionModel.value.row, false);\n                        this.selectionModel.row = row;\n                        this.toggleRowSelection(this.selectionModel.value.row, true);\n                    }\n                }\n                break;\n            case TableEditMode.SELECT_CELL:\n                {\n                    let pos = { col: this.selectionModel.col, row: this.selectionModel.row };\n                    switch (event.key) {\n                        case \"ArrowRight\":\n                            if (pos.col + 1 < this.adapter.colCount) {\n                                ++pos.col;\n                            }\n                            break;\n                        case \"ArrowLeft\":\n                            if (pos.col > 0) {\n                                --pos.col;\n                            }\n                            break;\n                        case \"ArrowDown\":\n                            if (pos.row + 1 < this.adapter.rowCount)\n                                ++pos.row;\n                            break;\n                        case \"ArrowUp\":\n                            if (pos.row > 0)\n                                --pos.row;\n                            break;\n                    }\n                    if (pos.col != this.selectionModel.col ||\n                        pos.row != this.selectionModel.row) {\n                        this.toggleCellSelection(this.selectionModel.value, false);\n                        this.selectionModel.value = pos;\n                        this.toggleCellSelection(this.selectionModel.value, true);\n                    }\n                }\n                break;\n        }\n    }\n    onFieldViewKeyDown(event, pos) {\n        switch (event.key) {\n            case \"ArrowDown\":\n                if (pos.row + 1 >= this.adapter.rowCount)\n                    break;\n                event.preventDefault();\n                this.goTo(pos.col, pos.row + 1);\n                break;\n            case \"ArrowUp\":\n                if (pos.row === 0)\n                    break;\n                event.preventDefault();\n                this.goTo(pos.col, pos.row - 1);\n                break;\n            case \"Tab\":\n                if (event.shiftKey) {\n                    if (pos.col > 0) {\n                        event.preventDefault();\n                        this.goTo(pos.col - 1, pos.row);\n                    }\n                    else {\n                        if (pos.row > 0) {\n                            event.preventDefault();\n                            this.goTo(this.adapter.colCount - 1, pos.row - 1);\n                        }\n                    }\n                }\n                else {\n                    if (pos.col + 1 < this.adapter.colCount) {\n                        event.preventDefault();\n                        this.goTo(pos.col + 1, pos.row);\n                    }\n                    else {\n                        if (pos.row + 1 < this.adapter.rowCount) {\n                            event.preventDefault();\n                            this.goTo(0, pos.row + 1);\n                        }\n                    }\n                }\n                break;\n        }\n    }\n    onFieldViewBlur(pos) {\n        const cell = this.getCellAt(pos.col, pos.row);\n        if (cell === undefined)\n            return;\n        const content = this.adapter.getDisplayCell(pos.col, pos.row);\n        const tmp = document.createElement('div');\n        if (Array.isArray(content)) {\n            content.forEach(e => tmp.appendChild(e));\n        }\n        else {\n            tmp.appendChild(content);\n        }\n        this.log(Log.USER, `TableView.onFieldViewBlur(${pos.col}, ${pos.row}): change \"${cell.innerHTML}\" to \"${tmp.innerHTML}\"`);\n        if (tmp.innerHTML == cell.innerHTML)\n            return;\n        this.log(Log.USER, `TableView.onFieldViewBlur(${pos.col}, ${pos.row})\"): cell is now \"${cell.innerHTML}\"`);\n        while (cell.childNodes.length > 0)\n            cell.removeChild(cell.childNodes[cell.childNodes.length - 1]);\n        this.log(Log.USER, `TableView.onFieldViewBlur(${pos.col}, ${pos.row})\"): cleared cell, it's now \"${cell.innerHTML}\"`);\n        if (Array.isArray(content))\n            content.forEach(e => cell.appendChild(e));\n        else\n            cell.appendChild(content);\n        this.log(Log.USER, `TableView.onFieldViewBlur(${pos.col}, ${pos.row})\"): cell is now \"${cell.innerHTML}\"`);\n        this.unadjustLayoutBeforeRender(pos);\n        setTimeout(() => {\n            this.adjustLayoutAfterRender();\n        }, 0);\n    }\n    connectedCallback() {\n        super.connectedCallback();\n        this.resizeEventListener = () => {\n            try {\n                this.adjustLayoutAfterRender();\n            }\n            catch (e) {\n                console.log(\"resizeEventListener caught exception in adjustLayoutAfterRender()\");\n                throw e;\n            }\n        };\n        window.addEventListener(\"resize\", this.resizeEventListener);\n        if (this.selectionModel === undefined) {\n            this.selectionModel = new SelectionModel();\n            this.selectionModel.modified.add(() => {\n                this.createSelection();\n            }, this);\n        }\n    }\n    disconnectedCallback() {\n        window.removeEventListener(\"resize\", this.resizeEventListener);\n    }\n}\n//# sourceMappingURL=TableView.js.map","import { jsx as _jsx } from \"toad.jsx/lib/jsx-runtime\";\nimport { AnimationBase } from \"../../util/animation.js\";\nexport class InsertRowAnimation extends AnimationBase {\n    constructor(table, event) {\n        super();\n        this.rowAnimationHeight = 0;\n        this.trHead = [];\n        this.trBody = [];\n        this.table = table;\n        this.event = event;\n    }\n    prepare() {\n        for (let i = 0; i < this.event.size; ++i) {\n            const trH = this.table.createDOMRowHeaderRow(this.event.index);\n            this.table.hiddenSizeCheckRowHead.appendChild(trH);\n            this.trHead.push(trH);\n            const trB = this.table.createDOMBodyRow(this.event.index + i);\n            this.table.hiddenSizeCheckBody.appendChild(trB);\n            this.trBody.push(trB);\n        }\n        const img = `url(\\\"data:image/svg+xml;utf8,<svg width='3' height='3' xmlns='http://www.w3.org/2000/svg'><line shape-rendering='crispEdges' x1='-1' y1='-1' x2='5' y2='5' stroke='%23888' /></svg>\\\")`;\n        this.trAnimationHead = _jsx(\"tr\", { style: { height: '0px', background: img }, children: _jsx(\"th\", { style: { padding: \"0\" } }, void 0) }, void 0);\n        this.table.rowHeadHead.insertBefore(this.trAnimationHead, this.table.rowHeadHead.children[this.event.index]);\n        this.trAnimationBody = _jsx(\"tr\", { style: { height: '0px', background: img } }, void 0);\n        for (let i = 0; i < this.table.adapter.colCount; ++i) {\n            this.trAnimationBody.appendChild(_jsx(\"td\", { style: { padding: \"0\" } }, void 0));\n            this.trAnimationBody.style.background = img;\n        }\n        this.table.bodyBody.insertBefore(this.trAnimationBody, this.table.bodyBody.children[this.event.index + 1]);\n    }\n    firstFrame() {\n        this.table.rowAnimationHeight = this.rowAnimationHeight = Math.max(this.table.hiddenSizeCheckBody.clientHeight, this.table.hiddenSizeCheckRowHead.clientHeight);\n    }\n    animationFrame(animationTime) {\n        const rowHeight = `${Math.round(animationTime * this.rowAnimationHeight)}px`;\n        this.trAnimationHead.style.height = this.trAnimationBody.style.height = rowHeight;\n        if (this.table.selectionModel !== undefined && this.table.selectionModel.row < this.event.index) {\n            const cell = this.table.getCellAt(this.table.selectionModel.value.col, this.table.selectionModel.value.row);\n            this.table.inputOverlay.adjustToCell(cell);\n        }\n    }\n    lastFrame() {\n        for (let i = 0; i < this.event.size; ++i) {\n            const rowHeight = `${Math.max(this.trHead[i].clientHeight, this.trBody[i].clientHeight)}px`;\n            const bodyStyle = this.trHead[i].style;\n            bodyStyle.height = bodyStyle.minHeight = bodyStyle.maxHeight = rowHeight;\n            const headStyle = this.trHead[i].style;\n            headStyle.height = headStyle.minHeight = headStyle.maxHeight = rowHeight;\n        }\n        this.table.rowHeadHead.replaceChild(this.trHead[0], this.trAnimationHead);\n        this.table.bodyBody.replaceChild(this.trBody[0], this.trAnimationBody);\n        for (let i = 1; i < this.event.size; ++i) {\n            this.table.rowHeadHead.insertBefore(this.trHead[i], this.trHead[i - 1].nextSibling);\n            this.table.bodyBody.insertBefore(this.trBody[i], this.trBody[i - 1].nextSibling);\n        }\n        if (this.table.selectionModel !== undefined && this.table.selectionModel.row >= this.event.index) {\n            this.table.selectionModel.row += this.event.size;\n        }\n        if (this.table.editView && this.table.selectionModel !== undefined && this.table.selectionModel.row < this.event.index) {\n            const cell = this.table.getCellAt(this.table.selectionModel.value.col, this.table.selectionModel.value.row);\n            this.table.inputOverlay.adjustToCell(cell);\n        }\n        this.table.adjustLayout(undefined);\n    }\n}\n//# sourceMappingURL=InsertRowAnimation.js.map","export class TableEvent {\n    constructor(type, index, size) {\n        this.type = type;\n        this.index = index;\n        this.size = size;\n    }\n    get col() {\n        return this.index;\n    }\n    get row() {\n        return this.size;\n    }\n}\n//# sourceMappingURL=TableEvent.js.map","import { TableEvent } from \"./TableEvent.js\";\nimport { TableEventType } from \"./TableEventType.js\";\nimport { TypedTableModel } from \"./TypedTableModel.js\";\nexport class ArrayTableModel extends TypedTableModel {\n    constructor(data, rowClass) {\n        super(rowClass);\n        this.data = data;\n    }\n    get rowCount() { return this.data ? this.data.length : 0; }\n    createRow() { return new this.nodeClass(); }\n    insert(row, rowData) {\n        if (row > this.rowCount) {\n            throw Error(`ArrayTableModel.insert(${row}) is out of range, model size is ${this.colCount}, ${this.rowCount}`);\n        }\n        if (rowData === undefined)\n            rowData = this.createRow();\n        let rowArray;\n        if (rowData instanceof Array)\n            rowArray = rowData;\n        else\n            rowArray = [rowData];\n        this.data.splice(row, 0, ...rowArray);\n        this.modified.trigger(new TableEvent(TableEventType.INSERT_ROW, row, rowArray.length));\n        return row;\n    }\n    remove(row, count = 1) {\n        if (row >= this.rowCount || row + count > this.rowCount) {\n            throw Error(`ArrayTableModel.remove(${row}, ${count}) is out of range, model size is ${this.colCount}, ${this.rowCount}`);\n        }\n        this.data.splice(row, count);\n        this.modified.trigger(new TableEvent(TableEventType.REMOVE_ROW, row, count));\n        return row;\n    }\n}\n//# sourceMappingURL=ArrayTableModel.js.map","import { jsx as _jsx, jsxs as _jsxs } from \"toad.jsx/lib/jsx-runtime\";\nimport { GenericTool } from \"../view/GenericTool.js\";\nimport { textAreaStyle } from \"../view/textAreaStyle.js\";\nimport { TableView } from \"./TableView.js\";\nimport { ArrayTableModel } from \"./ArrayTableModel.js\";\nexport class TableTool extends GenericTool {\n    constructor() {\n        super();\n        this.toolbar = _jsx(\"div\", { class: \"toolbar\" }, void 0);\n        this.buttonAddRowAbove = _jsx(\"button\", { class: \"left\", title: \"add row above\", children: _jsxs(\"svg\", { style: { display: \"block\" }, viewBox: \"0 0 13 13\", width: \"13\", height: \"13\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"0.5\", width: \"12\", height: \"12\", class: \"strokeFill\" }, void 0), _jsx(\"line\", { x1: \"0.5\", y1: \"8.5\", x2: \"12.5\", y2: \"8.5\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"4.5\", y1: \"8.5\", x2: \"4.5\", y2: \"13.5\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"8.5\", y1: \"8.5\", x2: \"8.5\", y2: \"13.5\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"6.5\", y1: \"2\", x2: \"6.5\", y2: \"7\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"4\", y1: \"4.5\", x2: \"9\", y2: \"4.5\", class: \"stroke\" }, void 0)] }, void 0) }, void 0);\n        this.buttonAddRowAbove.onclick = () => {\n            this.lastActiveTable?.focus();\n            const model = this.lastActiveTable?.model;\n            const selection = this.lastActiveTable?.selectionModel;\n            if (selection && model && model instanceof ArrayTableModel) {\n                model.insert(selection.row);\n            }\n        };\n        this.toolbar.appendChild(this.buttonAddRowAbove);\n        this.buttonAddRowBelow = _jsx(\"button\", { title: \"add row below\", children: _jsxs(\"svg\", { viewBox: \"0 0 13 13\", width: \"13\", height: \"13\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"0.5\", width: \"12\", height: \"12\", class: \"strokeFill\" }, void 0), _jsx(\"line\", { x1: \"0.5\", y1: \"4.5\", x2: \"12.5\", y2: \"4.5\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"4.5\", y1: \"0.5\", x2: \"4.5\", y2: \"4.5\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"8.5\", y1: \"0.5\", x2: \"8.5\", y2: \"4.5\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"6.5\", y1: \"6\", x2: \"6.5\", y2: \"11\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"4\", y1: \"8.5\", x2: \"9\", y2: \"8.5\", class: \"stroke\" }, void 0)] }, void 0) }, void 0);\n        this.buttonAddRowBelow.onclick = () => {\n            this.lastActiveTable?.focus();\n            const model = this.lastActiveTable?.model;\n            const selection = this.lastActiveTable?.selectionModel;\n            if (selection && model && model instanceof ArrayTableModel) {\n                model.insert(selection.row + 1);\n            }\n        };\n        this.toolbar.appendChild(this.buttonAddRowBelow);\n        this.buttonDeleteRow = _jsx(\"button\", { class: \"right\", title: \"delete row\", children: _jsxs(\"svg\", { viewBox: \"0 0 13 13\", width: \"13\", height: \"13\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"0.5\", width: \"12\", height: \"12\", class: \"strokeFill\" }, void 0), _jsx(\"line\", { x1: \"0.5\", y1: \"4.5\", x2: \"12.5\", y2: \"4.5\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"0.5\", y1: \"8.5\", x2: \"12.5\", y2: \"8.5\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"5.5\", y1: \"3.5\", x2: \"11.5\", y2: \"9.5\", class: \"stroke\", \"stroke-width\": \"1.5\" }, void 0), _jsx(\"line\", { x1: \"11.5\", y1: \"3.5\", x2: \"5.5\", y2: \"9.5\", class: \"stroke\", \"stroke-width\": \"1.5\" }, void 0)] }, void 0) }, void 0);\n        this.buttonDeleteRow.onclick = () => {\n            this.lastActiveTable?.focus();\n            const model = this.lastActiveTable?.model;\n            const selection = this.lastActiveTable?.selectionModel;\n            if (selection && model && model instanceof ArrayTableModel) {\n                model.remove(selection.row);\n            }\n        };\n        this.toolbar.appendChild(this.buttonDeleteRow);\n        this.toolbar.appendChild(document.createTextNode(\" \"));\n        this.buttonAddColumnLeft = _jsx(\"button\", { class: \"left\", title: \"add column left\", children: _jsxs(\"svg\", { viewBox: \"0 0 13 13\", width: \"13\", height: \"13\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"0.5\", width: \"12\", height: \"12\", class: \"strokeFill\" }, void 0), _jsx(\"line\", { x1: \"8.5\", y1: \"0.5\", x2: \"8.5\", y2: \"12.5\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"8.5\", y1: \"4.5\", x2: \"12.5\", y2: \"4.5\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"8.5\", y1: \"8.5\", x2: \"12.5\", y2: \"8.5\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"2\", y1: \"6.5\", x2: \"7\", y2: \"6.5\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"4.5\", y1: \"4\", x2: \"4.5\", y2: \"9\", class: \"stroke\" }, void 0)] }, void 0) }, void 0);\n        this.toolbar.appendChild(this.buttonAddColumnLeft);\n        this.buttonAddColumnRight = _jsx(\"button\", { title: \"add column right\", children: _jsxs(\"svg\", { viewBox: \"0 0 13 13\", width: \"13\", height: \"13\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"0.5\", width: \"12\", height: \"12\", class: \"strokeFill\" }, void 0), _jsx(\"line\", { x1: \"4.5\", y1: \"0.5\", x2: \"4.5\", y2: \"12.5\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"0.5\", y1: \"4.5\", x2: \"4.5\", y2: \"4.5\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"0.5\", y1: \"8.5\", x2: \"4.5\", y2: \"8.5\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"6\", y1: \"6.5\", x2: \"11\", y2: \"6.5\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"8.5\", y1: \"4\", x2: \"8.5\", y2: \"9\", class: \"stroke\" }, void 0)] }, void 0) }, void 0);\n        this.toolbar.appendChild(this.buttonAddColumnRight);\n        this.buttonDeleteColumn = _jsx(\"button\", { class: \"right\", title: \"delete column\", children: _jsxs(\"svg\", { viewBox: \"0 0 13 13\", width: \"13\", height: \"13\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"0.5\", width: \"12\", height: \"12\", class: \"strokeFill\" }, void 0), _jsx(\"line\", { x1: \"4.5\", y1: \"0.5\", x2: \"4.5\", y2: \"12.5\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"8.5\", y1: \"0.5\", x2: \"8.5\", y2: \"12.5\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"3.5\", y1: \"5.5\", x2: \"9.5\", y2: \"11.5\", class: \"stroke\", \"stroke-width\": \"1.5\" }, void 0), _jsx(\"line\", { x1: \"3.5\", y1: \"11.5\", x2: \"9.5\", y2: \"5.5\", class: \"stroke\", \"stroke-width\": \"1.5\" }, void 0)] }, void 0) }, void 0);\n        this.toolbar.appendChild(this.buttonDeleteColumn);\n        this.toolbar.appendChild(document.createTextNode(\" \"));\n        this.buttonAddNodeAbove = _jsx(\"button\", { class: \"left\", title: \"add node above\", children: _jsxs(\"svg\", { style: { display: \"block\", border: \"none\" }, viewBox: \"0 0 8 17\", width: \"8\", height: \"17\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"1.5\", width: \"6\", height: \"6\", class: \"strokeFill\" }, void 0), _jsx(\"rect\", { x: \"0.5\", y: \"9.5\", width: \"6\", height: \"6\", class: \"fill\" }, void 0), _jsx(\"line\", { x1: \"3.5\", y1: \"3\", x2: \"3.5\", y2: \"6\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"2\", y1: \"4.5\", x2: \"5\", y2: \"4.5\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"3.5\", y1: \"0\", x2: \"3.5\", y2: \"1\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"3.5\", y1: \"8\", x2: \"3.5\", y2: \"17\", class: \"stroke\" }, void 0)] }, void 0) }, void 0);\n        this.toolbar.appendChild(this.buttonAddNodeAbove);\n        this.buttonAddNodeBelow = _jsx(\"button\", { title: \"add node below\", children: _jsxs(\"svg\", { style: { display: \"block\", border: \"none\" }, viewBox: \"0 0 8 17\", width: \"8\", height: \"17\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"1.5\", width: \"6\", height: \"6\", class: \"fill\" }, void 0), _jsx(\"rect\", { x: \"0.5\", y: \"9.5\", width: \"6\", height: \"6\", class: \"strokeFill\" }, void 0), _jsx(\"line\", { x1: \"3.5\", y1: \"11\", x2: \"3.5\", y2: \"14\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"2\", y1: \"12.5\", x2: \"5\", y2: \"12.5\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"3.5\", y1: \"0\", x2: \"3.5\", y2: \"9\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"3.5\", y1: \"16\", x2: \"3.5\", y2: \"17\", class: \"stroke\" }, void 0)] }, void 0) }, void 0);\n        this.toolbar.appendChild(this.buttonAddNodeBelow);\n        this.buttonAddNodeParent = _jsx(\"button\", { title: \"add node parent\", children: _jsxs(\"svg\", { viewBox: \"0 0 13 17\", width: \"13\", height: \"17\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"1.5\", width: \"6\", height: \"6\", class: \"strokeFill\" }, void 0), _jsx(\"rect\", { x: \"6.5\", y: \"9.5\", width: \"6\", height: \"6\", class: \"fill\" }, void 0), _jsx(\"line\", { x1: \"7\", y1: \"4.5\", x2: \"10\", y2: \"4.5\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"9.5\", y1: \"4\", x2: \"9.5\", y2: \"9\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"3.5\", y1: \"3\", x2: \"3.5\", y2: \"6\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"2\", y1: \"4.5\", x2: \"5\", y2: \"4.5\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"3.5\", y1: \"0\", x2: \"3.5\", y2: \"1\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"3.5\", y1: \"8\", x2: \"3.5\", y2: \"17\", class: \"stroke\" }, void 0)] }, void 0) }, void 0);\n        this.buttonAddNodeParent.onclick = () => {\n        };\n        this.toolbar.appendChild(this.buttonAddNodeParent);\n        this.buttonAddNodeChild = _jsx(\"button\", { title: \"add node child\", children: _jsxs(\"svg\", { viewBox: \"0 0 13 17\", width: \"13\", height: \"17\", children: [_jsx(\"rect\", { x: \"0.5\", y: \"1.5\", width: \"6\", height: \"6\", class: \"fill\" }, void 0), _jsx(\"rect\", { x: \"6.5\", y: \"9.5\", width: \"6\", height: \"6\", class: \"strokeFill\" }, void 0), _jsx(\"line\", { x1: \"7\", y1: \"4.5\", x2: \"10\", y2: \"4.5\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"9.5\", y1: \"4\", x2: \"9.5\", y2: \"9\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"9.5\", y1: \"11\", x2: \"9.5\", y2: \"14\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"8\", y1: \"12.5\", x2: \"11\", y2: \"12.5\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"3.5\", y1: \"0\", x2: \"3.5\", y2: \"17\", class: \"stroke\" }, void 0)] }, void 0) }, void 0);\n        this.toolbar.appendChild(this.buttonAddNodeChild);\n        this.buttonDeleteNode = _jsx(\"button\", { class: \"right\", title: \"delete node\", children: _jsxs(\"svg\", { viewBox: \"0 0 10 17\", width: \"10\", height: \"17\", children: [_jsx(\"rect\", { x: \"1.5\", y: \"5.5\", width: \"6\", height: \"6\", class: \"strokeFill\" }, void 0), _jsx(\"line\", { x1: \"4.5\", y1: \"2\", x2: \"4.5\", y2: \"5\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"4.5\", y1: \"12\", x2: \"4.5\", y2: \"15\", class: \"stroke\" }, void 0), _jsx(\"line\", { x1: \"0.5\", y1: \"4.5\", x2: \"8.5\", y2: \"12.5\", class: \"stroke\", \"stroke-width\": \"1.5\" }, void 0), _jsx(\"line\", { x1: \"8.5\", y1: \"4.5\", x2: \"0.5\", y2: \"12.5\", class: \"stroke\", \"stroke-width\": \"1.5\" }, void 0)] }, void 0) }, void 0);\n        this.toolbar.appendChild(this.buttonDeleteNode);\n        this.attachShadow({ mode: 'open' });\n        this.shadowRoot.appendChild(document.importNode(textAreaStyle, true));\n        this.shadowRoot.appendChild(this.toolbar);\n    }\n    canHandle(view) {\n        return view instanceof TableView;\n    }\n    activate() {\n        this.lastActiveTable = GenericTool.activeView;\n        this.toolbar.classList.add(\"active\");\n    }\n    deactivate() {\n        this.lastActiveTable = undefined;\n        this.toolbar.classList.remove(\"active\");\n    }\n}\n//# sourceMappingURL=TableTool.js.map","import { TableAdapter } from \"./TableAdapter.js\";\nclass AbstractTypedTableAdapter extends TableAdapter {\n}\nexport class TypedTableAdapter extends AbstractTypedTableAdapter {\n}\n//# sourceMappingURL=TypedTableAdapter.js.map","import { TypedTableModel } from \"./TypedTableModel.js\";\nimport { TableEvent } from \"./TableEvent.js\";\nimport { TableEventType } from \"./TableEventType.js\";\nexport class RowInfo {\n    constructor(node, depth, open = true) {\n        this.node = node;\n        this.depth = depth;\n        this.open = open;\n    }\n}\nexport class TreeModel extends TypedTableModel {\n    constructor(nodeClass, root) {\n        super(nodeClass);\n        this.rows = new Array();\n        if (root !== undefined) {\n            this.createRowInfoHelper(this.rows, root, 0);\n        }\n    }\n    get colCount() { return 1; }\n    get rowCount() { return this.rows.length; }\n    getRow(node) {\n        for (let i = 0; i < this.rows.length; ++i) {\n            if (this.rows[i].node === node) {\n                return i;\n            }\n        }\n        return undefined;\n    }\n    addSiblingBefore(row) {\n        const nn = this.createNode();\n        if (this.rows.length === 0) {\n            row = 0;\n            this.setRoot(nn);\n            this.rows.push(new RowInfo(nn, 0));\n        }\n        else {\n            if (row === 0) {\n                this.setNext(nn, this.getRoot());\n                this.setRoot(nn);\n                this.rows.unshift(new RowInfo(nn, 0));\n            }\n            else {\n                this.setNext(nn, this.rows[row].node);\n                if (this.getNext(this.rows[row - 1].node) === this.rows[row].node)\n                    this.setNext(this.rows[row - 1].node, nn);\n                else\n                    this.setDown(this.rows[row - 1].node, nn);\n                this.rows.splice(row, 0, new RowInfo(nn, this.rows[row].depth));\n            }\n        }\n        this.modified.trigger(new TableEvent(TableEventType.INSERT_ROW, row, 1));\n        return row;\n    }\n    addSiblingAfter(row) {\n        const nn = this.createNode();\n        if (this.rows.length === 0) {\n            row = 0;\n            this.setRoot(nn);\n            this.rows.push(new RowInfo(nn, 0));\n        }\n        else {\n            this.setNext(nn, this.getNext(this.rows[row].node));\n            this.setNext(this.rows[row].node, nn);\n            const count = this.nodeCount(this.getDown(this.rows[row].node));\n            const depth = this.rows[row].depth;\n            row += count + 1;\n            this.rows.splice(row, 0, new RowInfo(nn, depth));\n        }\n        this.modified.trigger(new TableEvent(TableEventType.INSERT_ROW, row, 1));\n        return row;\n    }\n    addChildAfter(row) {\n        const nn = this.createNode();\n        if (this.rows.length === 0) {\n            this.setRoot(nn);\n            this.rows.push(new RowInfo(nn, 0));\n            this.modified.trigger(new TableEvent(TableEventType.INSERT_ROW, 0, 1));\n        }\n        else {\n            const down = this.getDown(this.rows[row].node);\n            const subtreeSize = this.nodeCount(down);\n            for (let i = 0; i < subtreeSize; ++i)\n                ++this.rows[row + 1 + i].depth;\n            this.setDown(nn, down);\n            this.setDown(this.rows[row].node, nn);\n            this.rows.splice(row + 1, 0, new RowInfo(nn, this.rows[row].depth + 1));\n            this.modified.trigger(new TableEvent(TableEventType.INSERT_ROW, row + 1, 1));\n        }\n        return row;\n    }\n    addParentBefore(row) {\n        const nn = this.createNode();\n        if (row === 0) {\n            for (let i = 0; i < this.rows.length; ++i)\n                ++this.rows[row + i].depth;\n            this.setDown(nn, this.getRoot());\n            this.setRoot(nn);\n            this.rows.unshift(new RowInfo(nn, 0));\n        }\n        else {\n            const depth = this.rows[row].depth;\n            const subtreeSize = this.nodeCount(this.getDown(this.rows[row].node)) + 1;\n            for (let i = 0; i < subtreeSize; ++i)\n                ++this.rows[row + i].depth;\n            this.setDown(nn, this.rows[row].node);\n            this.setNext(nn, this.getNext(this.rows[row].node));\n            this.setNext(this.rows[row].node, undefined);\n            if (this.getNext(this.rows[row - 1].node) === this.rows[row].node)\n                this.setNext(this.rows[row - 1].node, nn);\n            else\n                this.setDown(this.rows[row - 1].node, nn);\n            this.rows.splice(row, 0, new RowInfo(nn, depth));\n        }\n        this.modified.trigger(new TableEvent(TableEventType.INSERT_ROW, row, 1));\n        return row;\n    }\n    deleteAt(row) {\n        let down = this.getDown(this.rows[row].node);\n        if (down !== undefined) {\n            const subtreeSize = this.nodeCount(down) + 1;\n            for (let i = 0; i < subtreeSize; ++i)\n                --this.rows[row + i].depth;\n            this.append(down, this.getNext(this.rows[row].node));\n            this.setNext(this.rows[row].node, undefined);\n            if (row === 0) {\n                this.setRoot(down);\n            }\n            else {\n                this.setNext(this.rows[row - 1].node, down);\n            }\n        }\n        else {\n            if (row === 0) {\n                const next = this.getNext(this.rows[row].node);\n                this.setNext(this.rows[row].node, undefined);\n                this.setRoot(next);\n            }\n            else {\n                const next = this.getNext(this.rows[row].node);\n                this.setNext(this.rows[row].node, undefined);\n                if (this.getNext(this.rows[row - 1].node) === this.rows[row].node)\n                    this.setNext(this.rows[row - 1].node, next);\n                else\n                    this.setDown(this.rows[row - 1].node, next);\n            }\n        }\n        this.rows.splice(row, 1);\n        this.modified.trigger(new TableEvent(TableEventType.REMOVE_ROW, row, 1));\n        return row;\n    }\n    init() { }\n    toggleAt(row) {\n        if (this.rows[row].open) {\n            this.closeAt(row);\n        }\n        else {\n            this.openAt(row);\n        }\n    }\n    isOpen(row) {\n        return this.rows[row].open;\n    }\n    openAt(row) {\n        let r = this.rows[row];\n        if (r.open || this.getDown(r.node) === undefined)\n            return;\n        r.open = true;\n        const newRows = this.createRowInfo(row);\n        this.rows.splice(row + 1, 0, ...newRows);\n        this.modified.trigger(new TableEvent(TableEventType.INSERT_ROW, row + 1, newRows.length));\n    }\n    closeAt(row) {\n        let r = this.rows[row];\n        if (!r.open || this.getDown(r.node) === undefined)\n            return;\n        const count = this.getVisibleChildCount(row);\n        r.open = false;\n        this.rows.splice(row + 1, count);\n        this.modified.trigger(new TableEvent(TableEventType.REMOVE_ROW, row + 1, count));\n    }\n    createRowInfo(row) {\n        const newRows = new Array();\n        let r = this.rows[row];\n        if (r.open && this.getDown(r.node)) {\n            this.createRowInfoHelper(newRows, this.getDown(r.node), r.depth + 1);\n        }\n        return newRows;\n    }\n    createRowInfoHelper(newRows, node, depth) {\n        const rowInfo = new RowInfo(node, depth, false);\n        newRows.push(rowInfo);\n        if (rowInfo.open && this.getDown(node)) {\n            this.createRowInfoHelper(newRows, this.getDown(node), rowInfo.depth + 1);\n        }\n        if (this.getNext(node)) {\n            this.createRowInfoHelper(newRows, this.getNext(node), rowInfo.depth);\n        }\n    }\n    getVisibleChildCount(row) {\n        let r = this.rows[row];\n        let count = 1;\n        if (r.open && this.getDown(r.node)) {\n            const rows = this.getVisibleChildCountHelper(row + 1);\n            row += rows;\n            count += rows;\n        }\n        return count - 1;\n    }\n    getVisibleChildCountHelper(row) {\n        let r = this.rows[row];\n        let count = 1;\n        if (r.open && this.getDown(r.node)) {\n            const rows = this.getVisibleChildCountHelper(row + 1);\n            row += rows;\n            count += rows;\n        }\n        if (this.getNext(r.node)) {\n            const rows = this.getVisibleChildCountHelper(row + 1);\n            row += rows;\n            count += rows;\n        }\n        return count;\n    }\n    append(chain, node) {\n        if (node === undefined)\n            return;\n        let p = chain;\n        let next;\n        while (true) {\n            next = this.getNext(p);\n            if (next === undefined)\n                break;\n            p = next;\n        }\n        this.setNext(p, node);\n    }\n    nodeCount(node) {\n        if (node === undefined)\n            return 0;\n        return 1 + this.nodeCount(this.getDown(node)) + this.nodeCount(this.getNext(node));\n    }\n}\n//# sourceMappingURL=TreeModel.js.map","import { jsx as _jsx, Fragment as _Fragment, jsxs as _jsxs } from \"toad.jsx/lib/jsx-runtime\";\nimport { TypedTableAdapter } from \"./TypedTableAdapter.js\";\nimport { View } from \"../view/View.js\";\nexport class TreeNodeCell extends View {\n    constructor(model, rowinfo, label) {\n        super();\n        this.model = model;\n        this.rowinfo = rowinfo;\n        this.label = label;\n        this.attachShadow({ mode: 'open' });\n    }\n    connectedCallback() {\n        super.connectedCallback();\n        this.paint();\n    }\n    disconnectedCallback() {\n        super.disconnectedCallback();\n    }\n    paint() {\n        if (!this.shadowRoot)\n            return;\n        if (!this.parentElement)\n            return;\n        const row = this.model.getRow(this.rowinfo.node);\n        if (row === undefined)\n            return;\n        const rs = 8;\n        const sx = rs + 4;\n        const height = sx;\n        const dx = 3.5;\n        const dy = Math.round(height / 2 - rs / 2) - 0.5;\n        const rx = 3;\n        const width = this.rowinfo.depth * sx + sx + dx;\n        const content = _jsxs(_Fragment, { children: [_jsx(\"svg\", { width: width, height: sx, style: {\n                        verticalAlign: \"middle\",\n                        background: \"none\",\n                    } }, void 0), _jsx(\"span\", { style: {\n                        verticalAlign: \"middle\",\n                        padding: \"2px\",\n                    }, children: this.label }, void 0)] }, void 0);\n        const svg = content[0];\n        if (true) {\n            const rowinfo = this.rowinfo;\n            const d = rowinfo.depth;\n            if (this.model.getDown(rowinfo.node)) {\n                const x0 = d * sx + dx;\n                const box = _jsx(\"rect\", { x: x0, y: dy, width: rs, height: rs, stroke: \"#000\", fill: \"#fff\", cursor: \"pointer\" }, void 0);\n                svg.appendChild(box);\n                svg.appendChild(_jsx(\"line\", { x1: x0 + (rs >> 2), y1: dy + (rs >> 1), x2: x0 + rs - (rs >> 2), y2: dy + (rs >> 1), stroke: \"#000\", cursor: \"pointer\" }, void 0));\n                const plus = _jsx(\"line\", { x1: x0 + (rs >> 1), y1: dy + (rs >> 2), x2: x0 + (rs >> 1), y2: dy + rs - (rs >> 2), stroke: \"#000\", cursor: \"pointer\" }, void 0);\n                plus.style.display = rowinfo.open ? \"none\" : \"\";\n                svg.appendChild(plus);\n                svg.appendChild(_jsx(\"line\", { x1: x0 + rs, y1: dy + (rs >> 1), x2: x0 + rs + rx, y2: dy + (rs >> 1), stroke: \"#000\" }, void 0));\n                svg.onmousedown = (event) => {\n                    event.preventDefault();\n                    event.stopPropagation();\n                    const rowNumber = this.model.getRow(rowinfo.node);\n                    if (rowNumber === undefined) {\n                        console.log(\"  ==> couldn't find row number for node\");\n                        return;\n                    }\n                    const bounds = svg.getBoundingClientRect();\n                    const x = event.clientX - bounds.left;\n                    const y = event.clientY - bounds.top;\n                    if (x0 <= x && x <= x0 + rs && dy <= y && y <= dy + rs) {\n                        this.model?.toggleAt(rowNumber);\n                        plus.style.display = this.model.isOpen(rowNumber) ? \"none\" : \"\";\n                    }\n                };\n            }\n            else {\n                svg.appendChild(_jsx(\"line\", { x1: d * sx + dx + (rs >> 1), y1: \"0\", x2: d * sx + dx + (rs >> 1), y2: dy + (rs >> 1), stroke: \"#000\" }, void 0));\n                svg.appendChild(_jsx(\"line\", { x1: d * sx + dx + (rs >> 1), y1: dy + (rs >> 1), x2: d * sx + dx + rs + rx, y2: dy + (rs >> 1), stroke: \"#000\" }, void 0));\n            }\n            let lines = \"\";\n            for (let i = 0; i <= d; ++i) {\n                const x = i * sx + dx + (rs >> 1);\n                for (let j = row + 1; j < this.model.rowCount; ++j) {\n                    if (this.model.rows[j].depth < i)\n                        break;\n                    if (i === this.model.rows[j].depth) {\n                        if (i !== d) {\n                            lines += `<line x1='${x}' y1='0' x2='${x}' y2='100%' stroke='%23000' />`;\n                        }\n                        else {\n                            if (this.model.getNext(rowinfo.node) !== undefined) {\n                                lines += `<line x1='${x}' y1='0' x2='${x}' y2='100%' stroke='%23000' />`;\n                            }\n                        }\n                        break;\n                    }\n                }\n            }\n            if (this.model.getDown(rowinfo.node) === undefined || this.model.getNext(rowinfo.node) === undefined) {\n                const x = d * sx + dx + (rs >> 1);\n                lines += `<line x1='${x}' y1='0' x2='${x}' y2='50%' stroke='%23000' />`;\n            }\n            this.parentElement.style.background = `url(\\\"data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg'>${lines}</svg>\\\")`;\n            this.parentElement.style.backgroundRepeat = \"repeat-y\";\n        }\n        content.replaceIn(this.shadowRoot);\n    }\n}\nexport class TreeAdapter extends TypedTableAdapter {\n    isViewCompact() { return true; }\n    treeCell(row, label) {\n        if (!this.model)\n            return undefined;\n        return new TreeNodeCell(this.model, this.model.rows[row], label);\n    }\n}\n//# sourceMappingURL=TreeAdapter.js.map","import { TreeModel } from \"./TreeModel.js\";\nexport class TreeNodeModel extends TreeModel {\n    constructor(nodeClass, root) {\n        super(nodeClass, root);\n        this.root = root;\n    }\n    createNode() { return new this.nodeClass(); }\n    deleteNode(node) { }\n    getRoot() { return this.root; }\n    setRoot(node) { this.root = node; }\n    getDown(node) { return node.down; }\n    setDown(node, down) { node.down = down; }\n    getNext(node) { return node.next; }\n    setNext(node, next) { node.next = next; }\n}\n//# sourceMappingURL=TreeNodeModel.js.map","import { ArrayTableModel } from \"./ArrayTableModel.js\";\nexport class ArrayModel extends ArrayTableModel {\n    constructor(data, rowClass) {\n        super(data, rowClass);\n    }\n    get colCount() { return 10; }\n}\n//# sourceMappingURL=ArrayModel.js.map","import { TypedTableAdapter } from \"./TypedTableAdapter.js\";\nimport { TableEvent } from \"./TableEvent.js\";\nimport { TableEventType } from \"./TableEventType.js\";\nimport { TextModel } from \"../model/TextModel.js\";\nimport { Text } from \"../view/Text.js\";\nexport class ArrayAdapter extends TypedTableAdapter {\n    getColumnHead(col) {\n        const headers = this.getColumnHeads();\n        return document.createTextNode(headers[col]);\n    }\n    get colCount() {\n        return this.getRow(this.model?.data[0]).length;\n    }\n    getRowHead(row) {\n        return undefined;\n    }\n    getDisplayCell(col, row) {\n        const text = this.getField(col, row);\n        if (text === undefined)\n            return undefined;\n        return document.createTextNode(text);\n    }\n    getEditorCell(col, row) {\n        const text = this.getField(col, row);\n        if (text === undefined)\n            return undefined;\n        const model = new TextModel(text);\n        model.modified.add(() => {\n            this.setField(col, row, model.value);\n        });\n        const view = new Text();\n        view.setModel(model);\n        return view;\n    }\n    getField(col, row) {\n        if (!this.model)\n            return undefined;\n        return this.getRow(this.model.data[row])[col].toString();\n    }\n    setField(col, row, text) {\n        if (!this.model)\n            return;\n        this.getRow(this.model.data[row])[col].fromString(text);\n        this.model.modified.trigger(new TableEvent(TableEventType.CELL_CHANGED, col, row));\n    }\n}\n//# sourceMappingURL=ArrayAdapter.js.map","export class MenuEntry extends HTMLElement {\n}\n//# sourceMappingURL=MenuEntry.js.map","export * from \"toad.jsx\";\nexport { Matrix } from \"./Matrix.js\";\nexport { Signal } from \"./Signal.js\";\nexport { Controller } from \"./controller/Controller.js\";\nexport { Template } from \"./controller/Template.js\";\nexport { Dialog } from \"./controller/Dialog.js\";\nexport { bindModel, action, unbind, globalController } from \"./controller/globalController.js\";\nexport { Animator, AnimationBase } from \"./util/animation.js\";\nexport { Model } from \"./model/Model.js\";\nexport { Action } from \"./model/Action.js\";\nexport { GenericModel } from \"./model/GenericModel.js\";\nexport { TextModel } from \"./model/TextModel.js\";\nexport { HtmlModel } from \"./model/HtmlModel.js\";\nexport { NumberModel } from \"./model/NumberModel.js\";\nexport { BooleanModel } from \"./model/BooleanModel.js\";\nexport { OptionModel } from \"./model/OptionModel.js\";\nexport { OptionModelBase } from \"./model/OptionModelBase.js\";\nexport { View } from \"./view/View.js\";\nexport { ModelView } from \"./view/ModelView.js\";\nexport { ActionView } from \"./view/ActionView.js\";\nexport { Button } from \"./view/Button.js\";\nexport { Checkbox } from \"./view/Checkbox.js\";\nexport { Slider } from \"./view/Slider.js\";\nexport { Text } from \"./view/Text.js\";\nexport { TextArea } from \"./view/TextArea.js\";\nexport { GenericTool } from \"./view/GenericTool.js\";\nexport { ToolButton } from \"./view/ToolButton.js\";\nexport { TextTool } from \"./view/TextTool.js\";\nexport { SlotView } from \"./view/SlotView.js\";\nexport { ToadIf } from \"./view/ToadIf.js\";\nexport { Menu } from \"./menu/Menu.js\";\nexport { MenuButton } from \"./menu/MenuButton.js\";\nexport { MenuSpacer } from \"./menu/MenuSpacer.js\";\nexport { PopupMenu } from \"./menu/PopupMenu.js\";\nexport { TableView } from \"./table/TableView.js\";\nexport { TableTool } from \"./table/TableTool.js\";\nexport { TableAdapter } from \"./table/TableAdapter.js\";\nexport { TypedTableAdapter } from \"./table/TypedTableAdapter.js\";\nexport { TableModel } from \"./table/TableModel.js\";\nexport { ArrayTableModel } from \"./table/ArrayTableModel.js\";\nexport { TypedTableModel } from \"./table/TypedTableModel.js\";\nexport { SelectionModel } from \"./table/SelectionModel.js\";\nexport { TableEditMode } from \"./table/TableEditMode.js\";\nexport { TablePos } from \"./table/TablePos.js\";\nexport { TableEventType } from \"./table/TableEventType.js\";\nexport { TableEvent } from \"./table/TableEvent.js\";\nexport { TreeModel } from \"./table/TreeModel.js\";\nexport { TreeAdapter } from \"./table/TreeAdapter.js\";\nexport { TreeNodeModel } from \"./table/TreeNodeModel.js\";\nexport { ArrayModel } from \"./table/ArrayModel.js\";\nexport { ArrayAdapter } from \"./table/ArrayAdapter.js\";\nimport { View } from \"./view/View.js\";\nimport { Text } from \"./view/Text.js\";\nimport { TextArea } from \"./view/TextArea.js\";\nimport { Button } from \"./view/Button.js\";\nimport { Checkbox } from \"./view/Checkbox.js\";\nimport { Slider } from \"./view/Slider.js\";\nimport { ToolButton } from \"./view/ToolButton.js\";\nimport { TextTool } from \"./view/TextTool.js\";\nimport { SlotView } from \"./view/SlotView.js\";\nimport { ToadIf } from \"./view/ToadIf.js\";\nimport { Menu } from \"./menu/Menu.js\";\nimport { MenuButton } from \"./menu/MenuButton.js\";\nimport { MenuEntry } from \"./menu/MenuEntry.js\";\nimport { MenuSpacer } from \"./menu/MenuSpacer.js\";\nimport { TableView } from \"./table/TableView.js\";\nimport { TableTool } from \"./table/TableTool.js\";\nimport { TreeNodeCell } from \"./table/TreeAdapter.js\";\nlet _isInitialized = false;\nexport function initialize() {\n    _isInitialized = true;\n    View.define(\"toad-button\", Button);\n    View.define(\"toad-checkbox\", Checkbox);\n    View.define(\"toad-slider\", Slider);\n    View.define(\"toad-textarea\", TextArea);\n    View.define(\"toad-toolbutton\", ToolButton);\n    View.define(\"toad-texttool\", TextTool);\n    View.define(\"toad-text\", Text);\n    View.define(\"toad-if\", ToadIf);\n    View.define(\"toad-slot\", SlotView);\n    View.define(\"toad-menu\", Menu);\n    View.define(\"toad-menubutton\", MenuButton);\n    View.define(\"toad-menuentry\", MenuEntry);\n    View.define(\"toad-menuspacer\", MenuSpacer);\n    View.define(\"toad-table\", TableView);\n    View.define(\"toad-tabletool\", TableTool);\n    View.define(\"toad-treenodecell\", TreeNodeCell);\n}\nexport function isInitialized() {\n    return _isInitialized;\n}\ninitialize();\n//# sourceMappingURL=index.js.map","/*\n *  The TOAD JavaScript/TypeScript GUI Library\n *  Copyright (C) 2021 Mark-Andr Hopf <mhopf@mark13.org>\n *\n *  This program is free software: you can redistribute it and/or modify\n *  it under the terms of the GNU General Public License as published by\n *  the Free Software Foundation, either version 3 of the License, or\n *  (at your option) any later version.\n *\n *  This program is distributed in the hope that it will be useful,\n *  but WITHOUT ANY WARRANTY; without even the implied warranty of\n *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n *  GNU General Public License for more details.\n *\n *  You should have received a copy of the GNU General Public License\n *  along with this program.  If not, see <http://www.gnu.org/licenses/>.\n */\n\nimport {\n    TextModel, HtmlModel, NumberModel, BooleanModel,\n\n    Template,\n\n    ArrayModel, ArrayAdapter, TableAdapter,\n    TreeNode, TreeNodeModel, TreeAdapter,\n    bindModel as bind , action, refs\n} from 'toad.js'\n\n//\n// <toad-text>\n//\n\nlet textModel = new TextModel(\"\")\nbind(\"hello\", textModel)\n\n//\n// <toad-texttool> & <toad-textarea>\n//\nlet markupModel = new HtmlModel(\"\")\nmarkupModel.modified.add(() => {\n    document.getElementById(\"rawhtml\")!.innerText = markupModel.value\n})\nbind(\"markup\", markupModel)\n\n//\n// <toad-button>\n//\naction(\"hitMe\", () => {\n    textModel.value = \"Hit me too!\"\n    hitMeMore.enabled = true\n})\nvar hitMeMore = action(\"hitMeMore\", () => {\n    textModel.value = \"You hit me!\"\n    hitMeMore.enabled = false\n})\n\n//\n// <toad-checkbox> and <toad-if>\n//\n\nlet onoff = new BooleanModel(false)\nbind(\"onoff\", onoff)\n\n//\n// <toad-slider>\n//\n\nlet size = new NumberModel(42, { min: 0, max: 99 })\nbind(\"size\", size)\n\n// <toad-menu>\naction(\"file|logout\", () => {\n    alert(\"You are about to logout\")\n})\naction(\"help\", () => {\n    alert(\"Please.\")\n})\n\n//\n// Books\n//\n\nclass Book {\n    title: string = \"\"\n    author: string = \"\"\n    year: number = 1970\n}\n\nconst bookList = [\n    { title: \"The Moon Is A Harsh Mistress\", author: \"Robert A. Heinlein\", year: 1966 },\n    { title: \"Stranger In A Strange Land\", author: \"Robert A. Heinlein\", year: 1961 },\n    { title: \"The Fountains of Paradise\", author: \"Arthur C. Clarke\", year: 1979 },\n    { title: \"Rendezvous with Rama\", author: \"Arthur C. Clarke\", year: 1973 },\n    { title: \"2001: A Space Odyssey\", author: \"Arthur C. Clarke\", year: 1968 },\n    { title: \"Do Androids Dream of Electric Sheep?\", author: \"Philip K. Dick\", year: 1968 },\n    { title: \"A Scanner Darkly\", author: \"Philip K. Dick\", year: 1977 },\n    { title: \"Second Variety\", author: \"Philip K. Dick\", year: 1953 },\n]\n\nclass BookAdapter extends ArrayAdapter<ArrayModel<Book>> {\n    override getColumnHeads() { return [\"Title\", \"Author\", \"Year\"] }\n    override getRow(book: Book) { return refs(book, \"title\", \"author\", \"year\") }\n}\n\nfunction initializeBooks() {\n    TableAdapter.register(BookAdapter, ArrayModel, Book)\n    const model = new ArrayModel<Book>(bookList, Book)\n    bind(\"books\", model)\n}\n\n//\n// Tree\n//\n\nclass MyNode implements TreeNode {\n    label: string\n    next?: MyNode\n    down?: MyNode\n    static counter = 0\n    constructor() {\n        this.label = `#${MyNode.counter++}`\n    }\n}\n\nclass MyTreeAdapter extends TreeAdapter<MyNode> {\n    override getDisplayCell(col: number, row: number) {\n        return this.model && this.treeCell(row, this.model.rows[row].node.label)\n    }\n}\n\nfunction initializeTree(): void {\n    TreeAdapter.register(MyTreeAdapter, TreeNodeModel, MyNode)\n    let model = new TreeNodeModel(MyNode)\n    model.addSiblingAfter(0)\n    model.addChildAfter(0)\n    model.addChildAfter(1)\n    model.addSiblingAfter(2)\n    model.addSiblingAfter(1)\n    model.addChildAfter(4)\n    model.addSiblingAfter(0)\n    bind(\"tree\", model)\n}\n\nexport function main(): void {\n    initializeBooks()\n    initializeTree()\n}\n\nclass MyCodeButton extends HTMLElement {\n    condition = new BooleanModel(false)\n    constructor() {\n        super()\n        let template = new Template(\"my-code-button\") // FIXME: how about inlining the HTML?\n        let label = template.text(\"label\", \"Show Code\")\n        template.action(\"action\", () => {\n            if (this.condition.value) {\n                this.condition.value = false\n                label.value = \"Show Code\"\n            } else {\n                this.condition.value = true\n                label.value = \"Hide Code\"\n            }\n        })\n        this.attachShadow({ mode: 'open' })\n        this.shadowRoot!.appendChild(template.root)\n    }\n    connectedCallback() {\n        bind(this.getAttribute(\"condition\")!, this.condition) // FIXME: bind to parents context\n    }\n}\nwindow.customElements.define(\"my-code-button\", MyCodeButton)\n"],"names":["Reference","constructor","object","attribute","this","toString","get","set","value","Object","defineProperty","fromString","type","outValue","Number","parseFloat","Error","ref","Fragment","Array","props","super","children","i","length","e","document","createTextNode","replaceIn","element","childNodes","removeChild","appendTo","child","appendChild","jsx","nameOrConstructor","key","undefined","jsxs","namespace","name","tag","createElementNS","setInitialProperties","entries","setAction","setModel","classList","add","skey","svalue","regex","replace","upperCase","toLowerCase","style","setProperty","substring","addEventListener","substr","setAttributeNS","SignalLink","callback","id","Signal","callbacks","push","remove","splice","count","lock","locked","unlock","triggered","data","trigger","Model","modified","GenericModel","_value","BooleanModel","NumberModel","options","min","max","step","TextModel","promise","console","trace","HtmlModel","Action","parent","title","signal","_enabled","placeHolder","enabled","Controller","modelId2Models","Map","modelId2Views","view2ModelIds","sigChanged","registerAction","actionId","action","_registerModel","registerModel","modelId","model","modelsForModelId","Set","viewsForModelId","view","registerView","controller","log","modelIdsForView","modelsForView","unregisterView","modelIds","views","delete","size","clear","entry","bind","text","html","boolean","number","instantiateTemplate","t","querySelector","z","content","importNode","tmpl","getAttribute","nodeName","attributeOrUndefined","getPropertyValue","propertyName","pixel","pixelToNumber","window","getComputedStyle","horizontalPadding","verticalPadding","Template","template","root","dom.instantiateTemplate","registerViews","querySelectorAll","getModelId","getActionId","openHref","href","globalController","bindModel","AnimationBase","_stop","_firstFrame","_animationFrame","start","prepare","requestAnimationFrame","stop","animator","current","animation","next","animationFrame","lastFrame","firstFrame","time","startTime","elapsed","animationFrameCount","ease","k","Math","cos","PI","Animator","run","View","HTMLElement","static","customElements","define","hasAttribute","connectedCallback","error","disconnectedCallback","ModelView","init","updateModel","updateView","isConnected","ActionView","Function","isEnabled","buttonStyle","createElement","textContent","Button","button","onclick","disabled","attachShadow","mode","shadowRoot","_observer","MutationObserver","record","observer","_timer","clearTimeout","setTimeout","observe","childList","subtree","characterData","innerHTML","innerText","checkboxStyle","Checkbox","svg","rect","checkmark","toggle","event","onmousedown","focus","preventDefault","observedAttributes","attributeChangedCallback","oldValue","newValue","removeAttribute","setAttribute","Slider","input","oninput","String","textStyle","Text","blur","strValue","textAreaStyle","TextTool","texttool","toolbar","_jsx","class","buttonH1","execCommand","update","buttonH2","buttonH3","buttonH4","buttonBold","buttonItalic","buttonUnderline","buttonStrikeThrough","buttonSubscript","buttonSuperscript","buttonJustifyLeft","_jsxs","viewBox","width","height","x1","y1","x2","y2","stroke","buttonJustifyCenter","buttonJustifyRight","buttonUnorderedList","display","cx","cy","r","fill","buttonOrderedList","queryCommandValue","queryCommandState","TextArea","contentEditable","firstChild","target","nodeType","onkeydown","metaKey","updateTextTool","shiftKey","onkeyup","onmouseup","GenericTool","viewParents","parentElement","distance","closestParent","closestTool","closestToolDistance","MAX_SAFE_INTEGER","closestToolList","tool","allTools","values","canHandle","toolParent","depth","toolDistance","viewIndex","getIndex","closestNextSiblingIndex","MIN_SAFE_INTEGER","toolIndex","setActive","from","indexOf","activeTool","deactivate","activeView","activate","relatedTarget","focusOut","focusIn","toolbuttonStyle","ToolButton","img","stringValue","getValue","src","isValidStringValue","SlotView","ToadIf","menuStyle","MenuState","btoa","MenuButtonContainer","vertical","closeOnClose","state","WAIT","PopupMenu","parentButton","popup","node","down","isAvailable","createWindowAt","deleteWindow","show","master","parentBoundary","getBoundingClientRect","opacity","left","top","popupBoundary","innerHeight","innerWidth","placePopupHorizontal","placePopupVertical","hide","MenuButton","menuButton","stopPropagation","documentMouseUp","removeEventListener","capture","buttonDown","dispatchEvent","MouseEvent","DOWN","UP_N_HOLD","active","DOWN_N_HOLD","documentMouseDown","tagName","collapse","DOWN_N_OUTSIDE","DOWN_N_INSIDE_AGAIN","onmouseout","inside","onmouseover","label","span","insertBefore","openPopup","closePopup","oldActive","MenuNode","shortcut","parentView","flexGrow","Menu","config","tabIndex","config2nodes","referenceActions","createShadowDOM","layout2nodes","newnode","dom.attribute","dom.attributeOrUndefined","space","sub","findNode","str","strpos","right","n","MenuSpacer","scrollIntoView","scrollableParent","findScrollableParent","parentRect","clientRect","body","x","y","GAP","clientLeft","scrollLeft","clientRight","clientTop","scrollTop","clientBottom","bottom","parentWidth","clientWidth","parentHeight","clientHeight","calculateScrollGoal","scrollable","startX","startY","activeGoal","concurrentScroll","scrollX","pageXOffset","scrollY","pageYOffset","deltaX","deltaY","nx","ny","scrollTo","animateStep","smoothScroll","position","scrollBy","behavior","idSource","Date","now","userAgent","TableEditMode","TableEventType","ROUNDING_TOLERANCE","navigator","RegExp","join","test","el","isScrollable","isScrollableY","hasScrollableSpace","canOverflow","isScrollableX","axis","scrollWidth","scrollHeight","overflowValue","TableModel","isEmpty","colCount","rowCount","TablePos","col","row","SelectionModel","EDIT_CELL","TypedTableModel","nodeClass","TableAdapter","getColumnHead","getRowHead","getDisplayCell","getEditorCell","isViewCompact","adapter","typeToModel","modelToAdapter","dataType","getPrototypeOf","baseClass","keys","msg","modelX","typeToAdapterX","typeX","adapterX","tableStyle","InputOverlay","HTMLDivElement","div","first","second","firstPrevious","parentsOfFirstNode","parentNode","secondPrevious","lookup","dom.isNodeBeforeNode","focusInFromRight","focusInFromLeft","setViewRect","prototype","unsetViewRect","setEditView","adjustToCell","fieldView","savedScrollLeft","savedScrollTop","hasChildNodes","hasFocus","activeElement","dom.hasFocus","FocusEvent","replaceChild","cell","boundary","tr","tbody","offsetLeft","offsetTop","dom.horizontalPadding","SelectionIs","Log","RemoveRowAnimation","table","rowAnimationHeight","hadFocus","overlayTopDrift","editView","selectionModel","index","selectionIs","BEFORE_REMOVED_AREA","bodyBody","INSIDE_REMOVED_AREA_AND_NO_FURTHER_ROWS","INSIDE_REMOVED_AREA","prepareInputOverlayForPosition","BEHIND_REMOVED_AREA","rowHeadHead","deleteRow","trAnimationHead","trAnimationBody","minHeight","maxHeight","padding","background","inputOverlay","overlayTop","inverseValue","InsertRowAnimation","trHead","trBody","trH","createDOMRowHeaderRow","hiddenSizeCheckRowHead","trB","createDOMBodyRow","hiddenSizeCheckBody","animationTime","rowHeight","round","getCellAt","bodyStyle","headStyle","nextSibling","adjustLayout","TableView","insideGoTo","rootDiv","_Fragment","onRootDivKeyDown","scrollDiv","onscroll","rowHeadDiv","colHeadDiv","bodyTable","USER","goToCell","goToFirstCell","goToLastCell","what","createSelection","modelChanged","updateCompact","forEach","INSERT_ROW","REMOVE_ROW","CELL_CHANGED","onFieldViewBlur","createColumnHeader","createRowHeader","createBody","adjustLayoutAfterRender","stack","updateHeader","column","headTable","headRow","colHeadTable","colHeadRow","rowHeadTable","fillerForMissingScrollbar","noHeader","minWidth","border","bodyRow","isArray","result","SELECTION","SELECT_CELL","allSelected","selected","toggleCellSelection","SELECT_ROW","toggleRowSelection","pos","unadjustLayoutBeforeRender","unadjustLayoutColumnBeforeRender","head","maxWidth","LAYOUT","columnHeader","columnBody","headWidth","bodyWidth","rowHeader","rowBody","headHeight","dom.verticalPadding","bodyHeight","columnHeadBounds","rowHeadBounds","scrollBounds","cellsBounds","computedStyle","computedWidth","computedHeight","overflowX","overflowY","enoughHorizontalSpace","enoughVerticalSpace","requiredWidth","requiredHeight","outerBounds","hostBounds","verticalScrollbarWidth","horizontalScrollbarHeight","prepareInputOverlayForCell","getCellPosition","setSelectionTo","onFieldViewKeyDown","preventScroll","flag","rowElement","goTo","tmp","resizeEventListener","TableEvent","ArrayTableModel","rowClass","createRow","insert","rowData","rowArray","TableTool","buttonAddRowAbove","lastActiveTable","selection","buttonAddRowBelow","buttonDeleteRow","buttonAddColumnLeft","buttonAddColumnRight","buttonDeleteColumn","buttonAddNodeAbove","buttonAddNodeBelow","buttonAddNodeParent","buttonAddNodeChild","buttonDeleteNode","AbstractTypedTableAdapter","TypedTableAdapter","RowInfo","open","TreeModel","rows","createRowInfoHelper","getRow","addSiblingBefore","nn","createNode","setRoot","setNext","getRoot","unshift","getNext","setDown","addSiblingAfter","nodeCount","getDown","addChildAfter","subtreeSize","addParentBefore","deleteAt","append","toggleAt","closeAt","openAt","isOpen","newRows","createRowInfo","getVisibleChildCount","rowInfo","getVisibleChildCountHelper","chain","p","TreeNodeCell","rowinfo","paint","sx","rs","dx","dy","verticalAlign","d","x0","box","cursor","plus","rowNumber","bounds","clientX","clientY","lines","j","backgroundRepeat","TreeAdapter","treeCell","TreeNodeModel","deleteNode","ArrayModel","ArrayAdapter","headers","getColumnHeads","getField","setField","MenuEntry","textModel","markupModel","getElementById","hitMeMore","alert","Book","bookList","author","year","BookAdapter","book","attributes","map","a","refs","MyNode","counter","MyTreeAdapter","MyCodeButton","condition","register","initializeTree"],"mappings":"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"}